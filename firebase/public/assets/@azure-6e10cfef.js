import{_ as pe,a as $,b as S,c as fe,d as B}from"./tslib-87ab7759.js";function ur(t){return typeof t<"u"&&t!==null}function Et(t,e){if(!ur(t)||typeof t!="object")return!1;for(const n of e)if(!mr(t,n))return!1;return!0}function mr(t,e){return typeof t=="object"&&e in t}function Be(t){return Et(t,["name","key"])&&typeof t.key=="string"&&typeof t.name=="string"}function je(t){return Et(t,["signature"])&&typeof t.signature=="string"}function Fe(t){const e=t;return e&&typeof e.getToken=="function"&&(e.signRequest===void 0||e.getToken.length>0)}function ut(t,e=!0){const n=t.toISOString();return e?n.substring(0,n.length-1)+"0000Z":n.substring(0,n.length-5)+"Z"}const pr="HTTP/1.1",A=`\r
`,vt="https://storage.azure.com/.default",ye={AUTHORIZATION:"authorization",CONTENT_LENGTH:"content-length",CONTENT_MD5:"content-md5",CONTENT_TYPE:"content-type",CONTENT_TRANSFER_ENCODING:"content-transfer-encoding",DATE:"date",X_MS_DATE:"x-ms-date",X_MS_VERSION:"x-ms-version"},Ct=["Access-Control-Allow-Origin","Cache-Control","Content-Length","Content-Type","Date","Prefer","Preference-Applied","Request-Id","traceparent","Transfer-Encoding","User-Agent","x-ms-client-request-id","x-ms-user-agent","x-ms-date","x-ms-error-code","x-ms-request-id","x-ms-return-client-request-id","x-ms-version","Accept-Ranges","Accept","Content-Disposition","Content-Encoding","Content-Language","Content-MD5","Content-Range","ETag","Last-Modified","Server","Vary","x-ms-content-crc64","x-ms-copy-action","x-ms-copy-completion-time","x-ms-copy-id","x-ms-copy-progress","x-ms-copy-status","x-ms-continuation-NextTableName","x-ms-continuation-NextPartitionKey","x-ms-continuation-NextRowKey","x-ms-has-immutability-policy","x-ms-has-legal-hold","x-ms-lease-state","x-ms-lease-status","x-ms-range","x-ms-request-server-encrypted","x-ms-server-encrypted","x-ms-snapshot","x-ms-source-range","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","x-ms-access-tier","x-ms-access-tier-change-time","x-ms-access-tier-inferred","x-ms-account-kind","x-ms-archive-status","x-ms-copy-destination-snapshot","x-ms-creation-time","x-ms-default-encryption-scope","x-ms-delete-type-permanent","x-ms-deny-encryption-scope-override","x-ms-encryption-algorithm","x-ms-incremental-copy","x-ms-lease-action","x-ms-lease-break-period","x-ms-lease-duration","x-ms-lease-id","x-ms-lease-time","x-ms-page-write","x-ms-proposed-lease-id","x-ms-range-get-content-md5","x-ms-rehydrate-priority","x-ms-sequence-number-action","x-ms-sku-name","x-ms-source-content-md5","x-ms-source-if-match","x-ms-source-if-modified-since","x-ms-source-if-none-match","x-ms-source-if-unmodified-since","x-ms-tag-count","x-ms-encryption-key-sha256"],fr="tablesSecondaryEndpointPolicy",ze="tables-secondary-endpoint",yr="-secondary",hr={name:fr,sendRequest:async(t,e)=>(t.headers.get(ze)&&(t.headers.delete(ze),t.url=br(t.url)),e(t))};function gr(t){var e;const n={[ze]:"true"};return Object.assign(Object.assign({},t),{requestOptions:Object.assign(Object.assign({},t.requestOptions),{customHeaders:Object.assign(Object.assign({},(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders),n)})})}function br(t){const e=new URL(t),n=e.hostname.split(".");return n.length>1&&(n[0]=`${n[0]}${yr}`),e.hostname=n.join("."),e.toString()}const Ae="$",Rt="_";if(!document||!DOMParser||!Node||!XMLSerializer)throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');let K;try{typeof self.trustedTypes<"u"&&(K=self.trustedTypes.createPolicy("@azure/core-xml#xml.browser",{createHTML:t=>t}))}catch{console.warn('Could not create trusted types policy "@azure/core-xml#xml.browser"')}const ue=document.implementation.createDocument(null,null,null),Ot=new DOMParser;function zt(t,e={}){var n,r,i,a,s,l;try{const c={rootName:(n=e.rootName)!==null&&n!==void 0?n:"",includeRoot:(r=e.includeRoot)!==null&&r!==void 0?r:!1,xmlCharKey:(i=e.xmlCharKey)!==null&&i!==void 0?i:Rt,cdataPropName:(a=e.cdataPropName)!==null&&a!==void 0?a:"__cdata",stopNodes:(s=e.stopNodes)!==null&&s!==void 0?s:[]},o=Ot.parseFromString((l=K==null?void 0:K.createHTML(t))!==null&&l!==void 0?l:t,"application/xml");Nr(o);let d;return c.includeRoot?d=Me(o,c):d=Me(o.childNodes[0],c),Promise.resolve(d)}catch(c){return Promise.reject(c)}}let te;function xr(){var t,e;if(te===void 0)try{const n=(t=K==null?void 0:K.createHTML("INVALID"))!==null&&t!==void 0?t:"INVALID";te=(e=Ot.parseFromString(n,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)!==null&&e!==void 0?e:""}catch{te=""}return te}function Nr(t){const e=t.getElementsByTagName("parsererror");if(e.length>0&&xr()){for(let n=0;n<e.length;n++)if(e[n].namespaceURI===te)throw new Error(e[n].innerHTML)}}function Pr(t){return!!t.attributes}function Sr(t){return Pr(t)&&t.hasAttributes()?t:void 0}function Me(t,e){var n;let r={};const i=t.childNodes.length,a=t.childNodes[0],s=a&&i===1&&a.nodeType===Node.TEXT_NODE&&a.nodeValue||void 0,l=Sr(t);if(l){r[Ae]={};for(let c=0;c<l.attributes.length;c++){const o=l.attributes[c];r[Ae][o.nodeName]=o.nodeValue}s&&(r[e.xmlCharKey]=s)}else i===0?r="":s&&(r=s);if(!s)for(let c=0;c<i;c++){const o=t.childNodes[c];if((o==null?void 0:o.nodeType)===Node.CDATA_SECTION_NODE)r=o.textContent;else if(((n=o==null?void 0:o.firstChild)===null||n===void 0?void 0:n.nodeType)===Node.CDATA_SECTION_NODE)r[o.nodeName]=o.textContent;else if(o.nodeType!==Node.TEXT_NODE){const d=Me(o,e);r[o.nodeName]?Array.isArray(r[o.nodeName])?r[o.nodeName].push(d):r[o.nodeName]=[r[o.nodeName],d]:r[o.nodeName]=d}}return r}const Tr=new XMLSerializer;function At(t,e={}){var n,r,i,a,s;const l={rootName:(n=e.rootName)!==null&&n!==void 0?n:"root",includeRoot:(r=e.includeRoot)!==null&&r!==void 0?r:!1,xmlCharKey:(i=e.xmlCharKey)!==null&&i!==void 0?i:Rt,cdataPropName:(a=e.cdataPropName)!==null&&a!==void 0?a:"__cdata",stopNodes:(s=e.stopNodes)!==null&&s!==void 0?s:[]},c=Ie(t,l.rootName,l)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Tr.serializeToString(c)}function wr(t){const e=[];for(const n of Object.keys(t)){const r=ue.createAttribute(n);r.value=t[n].toString(),e.push(r)}return e}function Ie(t,e,n){if(t==null||typeof t=="string"||typeof t=="number"||typeof t=="boolean"){const r=ue.createElement(e);return r.textContent=t==null?"":t.toString(),[r]}else if(Array.isArray(t)){const r=[];for(const i of t)for(const a of Ie(i,e,n))r.push(a);return r}else if(typeof t=="object"){const r=ue.createElement(e);for(const i of Object.keys(t))if(i===Ae)for(const a of wr(t[i]))r.attributes.setNamedItem(a);else if(i===n.xmlCharKey)r.textContent=t[i].toString();else if(i===n.cdataPropName){const a=ue.createCDATASection(t[i].toString());r.appendChild(a)}else for(const a of Ie(t[i],i,n))r.appendChild(a);return[r]}else throw new Error(`Illegal value passed to buildObject: ${t}`)}function Mt(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function It(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}const w="$",ie="_";function Er(t,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||(e==null?void 0:e.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))!==null||t===void 0||t===null)}const vr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Cr(t){return vr.test(t)}const Rr=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function Or(t){return Rr.test(t)}function zr(t){const e=Object.assign(Object.assign({},t.headers),t.body);return t.hasNullableType&&Object.getOwnPropertyNames(e).length===0?t.shouldWrapBody?{body:null}:null:t.shouldWrapBody?Object.assign(Object.assign({},t.headers),{body:t.body}):e}function mt(t,e){var n,r;const i=t.parsedHeaders;if(t.request.method==="HEAD")return Object.assign(Object.assign({},i),{body:t.parsedBody});const a=e&&e.bodyMapper,s=!!(a!=null&&a.nullable),l=a==null?void 0:a.type.name;if(l==="Stream")return Object.assign(Object.assign({},i),{blobBody:t.blobBody,readableStreamBody:t.readableStreamBody});const c=l==="Composite"&&a.type.modelProperties||{},o=Object.keys(c).some(d=>c[d].serializedName==="");if(l==="Sequence"||o){const d=(n=t.parsedBody)!==null&&n!==void 0?n:[];for(const m of Object.keys(c))c[m].serializedName&&(d[m]=(r=t.parsedBody)===null||r===void 0?void 0:r[m]);if(i)for(const m of Object.keys(i))d[m]=i[m];return s&&!t.parsedBody&&!i&&Object.getOwnPropertyNames(c).length===0?null:d}return zr({body:t.parsedBody,headers:i,hasNullableType:s,shouldWrapBody:Er(t.parsedBody,l)})}class Ar{constructor(e={},n=!1){this.modelMappers=e,this.isXML=n}validateConstraints(e,n,r){const i=(a,s)=>{throw new Error(`"${r}" with value "${n}" should satisfy the constraint "${a}": ${s}.`)};if(e.constraints&&n!==void 0&&n!==null){const{ExclusiveMaximum:a,ExclusiveMinimum:s,InclusiveMaximum:l,InclusiveMinimum:c,MaxItems:o,MaxLength:d,MinItems:m,MinLength:u,MultipleOf:f,Pattern:p,UniqueItems:y}=e.constraints;if(a!==void 0&&n>=a&&i("ExclusiveMaximum",a),s!==void 0&&n<=s&&i("ExclusiveMinimum",s),l!==void 0&&n>l&&i("InclusiveMaximum",l),c!==void 0&&n<c&&i("InclusiveMinimum",c),o!==void 0&&n.length>o&&i("MaxItems",o),d!==void 0&&n.length>d&&i("MaxLength",d),m!==void 0&&n.length<m&&i("MinItems",m),u!==void 0&&n.length<u&&i("MinLength",u),f!==void 0&&n%f!==0&&i("MultipleOf",f),p){const h=typeof p=="string"?new RegExp(p):p;(typeof n!="string"||n.match(h)===null)&&i("Pattern",p)}y&&n.some((h,P,b)=>b.indexOf(h)!==P)&&i("UniqueItems",y)}}serialize(e,n,r,i={xml:{}}){var a,s,l;const c={xml:{rootName:(a=i.xml.rootName)!==null&&a!==void 0?a:"",includeRoot:(s=i.xml.includeRoot)!==null&&s!==void 0?s:!1,xmlCharKey:(l=i.xml.xmlCharKey)!==null&&l!==void 0?l:ie}};let o={};const d=e.type.name;r||(r=e.serializedName),d.match(/^Sequence$/i)!==null&&(o=[]),e.isConstant&&(n=e.defaultValue);const{required:m,nullable:u}=e;if(m&&u&&n===void 0)throw new Error(`${r} cannot be undefined.`);if(m&&!u&&n==null)throw new Error(`${r} cannot be null or undefined.`);if(!m&&u===!1&&n===null)throw new Error(`${r} cannot be null.`);return n==null||d.match(/^any$/i)!==null?o=n:d.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?o=$r(d,r,n):d.match(/^Enum$/i)!==null?o=Hr(r,e.type.allowedValues,n):d.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?o=Lr(d,n,r):d.match(/^ByteArray$/i)!==null?o=kr(r,n):d.match(/^Base64Url$/i)!==null?o=Ur(r,n):d.match(/^Sequence$/i)!==null?o=Kr(this,e,n,r,!!this.isXML,c):d.match(/^Dictionary$/i)!==null?o=Vr(this,e,n,r,!!this.isXML,c):d.match(/^Composite$/i)!==null&&(o=jr(this,e,n,r,!!this.isXML,c)),o}deserialize(e,n,r,i={xml:{}}){var a,s,l,c;const o={xml:{rootName:(a=i.xml.rootName)!==null&&a!==void 0?a:"",includeRoot:(s=i.xml.includeRoot)!==null&&s!==void 0?s:!1,xmlCharKey:(l=i.xml.xmlCharKey)!==null&&l!==void 0?l:ie},ignoreUnknownProperties:(c=i.ignoreUnknownProperties)!==null&&c!==void 0?c:!1};if(n==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(n=[]),e.defaultValue!==void 0&&(n=e.defaultValue),n;let d;const m=e.type.name;if(r||(r=e.serializedName),m.match(/^Composite$/i)!==null)d=Wr(this,e,n,r,o);else{if(this.isXML){const u=o.xml.xmlCharKey;n[w]!==void 0&&n[u]!==void 0&&(n=n[u])}m.match(/^Number$/i)!==null?(d=parseFloat(n),isNaN(d)&&(d=n)):m.match(/^Boolean$/i)!==null?n==="true"?d=!0:n==="false"?d=!1:d=n:m.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?d=n:m.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?d=new Date(n):m.match(/^UnixTime$/i)!==null?d=Dr(n):m.match(/^ByteArray$/i)!==null?d=It(n):m.match(/^Base64Url$/i)!==null?d=_r(n):m.match(/^Sequence$/i)!==null?d=Xr(this,e,n,r,o):m.match(/^Dictionary$/i)!==null&&(d=Gr(this,e,n,r,o))}return e.isConstant&&(d=e.defaultValue),d}}function We(t={},e=!1){return new Ar(t,e)}function Mr(t,e){let n=t.length;for(;n-1>=0&&t[n-1]===e;)--n;return t.substr(0,n)}function Ir(t){if(!t)return;if(!(t instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");const e=Mt(t);return Mr(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function _r(t){if(t){if(t&&typeof t.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return t=t.replace(/-/g,"+").replace(/_/g,"/"),It(t)}}function _e(t){const e=[];let n="";if(t){const r=t.split(".");for(const i of r)i.charAt(i.length-1)==="\\"?n+=i.substr(0,i.length-1)+".":(n+=i,e.push(n),n="")}return e}function qr(t){if(t)return typeof t.valueOf()=="string"&&(t=new Date(t)),Math.floor(t.getTime()/1e3)}function Dr(t){if(t)return new Date(t*1e3)}function $r(t,e,n){if(n!=null){if(t.match(/^Number$/i)!==null){if(typeof n!="number")throw new Error(`${e} with value ${n} must be of type number.`)}else if(t.match(/^String$/i)!==null){if(typeof n.valueOf()!="string")throw new Error(`${e} with value "${n}" must be of type string.`)}else if(t.match(/^Uuid$/i)!==null){if(!(typeof n.valueOf()=="string"&&Or(n)))throw new Error(`${e} with value "${n}" must be of type string and a valid uuid.`)}else if(t.match(/^Boolean$/i)!==null){if(typeof n!="boolean")throw new Error(`${e} with value ${n} must be of type boolean.`)}else if(t.match(/^Stream$/i)!==null){const r=typeof n;if(r!=="string"&&typeof n.pipe!="function"&&!(n instanceof ArrayBuffer)&&!ArrayBuffer.isView(n)&&!((typeof Blob=="function"||typeof Blob=="object")&&n instanceof Blob)&&r!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, NodeJS.ReadableStream, or () => NodeJS.ReadableStream.`)}}return n}function Hr(t,e,n){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${t} as an Enum Type.`);if(!e.some(i=>typeof i.valueOf()=="string"?i.toLowerCase()===n.toLowerCase():i===n))throw new Error(`${n} is not a valid value for ${t}. The valid values are: ${JSON.stringify(e)}.`);return n}function kr(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=Mt(e)}return e}function Ur(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=Ir(e)}return e}function Lr(t,e,n){if(e!=null){if(t.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(t.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(t.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(t.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=qr(e)}else if(t.match(/^TimeSpan$/i)!==null&&!Cr(e))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function Kr(t,e,n,r,i,a){var s;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let l=e.type.element;if(!l||typeof l!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);l.type.name==="Composite"&&l.type.className&&(l=(s=t.modelMappers[l.type.className])!==null&&s!==void 0?s:l);const c=[];for(let o=0;o<n.length;o++){const d=t.serialize(l,n[o],r,a);if(i&&l.xmlNamespace){const m=l.xmlNamespacePrefix?`xmlns:${l.xmlNamespacePrefix}`:"xmlns";l.type.name==="Composite"?(c[o]=Object.assign({},d),c[o][w]={[m]:l.xmlNamespace}):(c[o]={},c[o][a.xml.xmlCharKey]=d,c[o][w]={[m]:l.xmlNamespace})}else c[o]=d}return c}function Vr(t,e,n,r,i,a){if(typeof n!="object")throw new Error(`${r} must be of type object.`);const s=e.type.value;if(!s||typeof s!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const l={};for(const c of Object.keys(n)){const o=t.serialize(s,n[c],r,a);l[c]=Dt(s,o,i,a)}if(i&&e.xmlNamespace){const c=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",o=l;return o[w]={[c]:e.xmlNamespace},o}return l}function Br(t,e,n){const r=e.type.additionalProperties;if(!r&&e.type.className){const i=_t(t,e,n);return i==null?void 0:i.type.additionalProperties}return r}function _t(t,e,n){const r=e.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return t.modelMappers[r]}function qt(t,e,n){let r=e.type.modelProperties;if(!r){const i=_t(t,e,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(r=i==null?void 0:i.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${e.type.className}" for object "${n}".`)}return r}function jr(t,e,n,r,i,a){if(he(t,e)&&(e=$t(t,e,n,"clientName")),n!=null){const s={},l=qt(t,e,r);for(const o of Object.keys(l)){const d=l[o];if(d.readOnly)continue;let m,u=s;if(t.isXML)d.xmlIsWrapped?m=d.xmlName:m=d.xmlElementName||d.xmlName;else{const f=_e(d.serializedName);m=f.pop();for(const p of f){const y=u[p];y==null&&(n[o]!==void 0&&n[o]!==null||d.defaultValue!==void 0)&&(u[p]={}),u=u[p]}}if(u!=null){if(i&&e.xmlNamespace){const P=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";u[w]=Object.assign(Object.assign({},u[w]),{[P]:e.xmlNamespace})}const f=d.serializedName!==""?r+"."+d.serializedName:r;let p=n[o];const y=he(t,e);y&&y.clientName===o&&p==null&&(p=e.serializedName);const h=t.serialize(d,p,f,a);if(h!==void 0&&m!==void 0&&m!==null){const P=Dt(d,h,i,a);i&&d.xmlIsAttribute?(u[w]=u[w]||{},u[w][m]=h):i&&d.xmlIsWrapped?u[m]={[d.xmlElementName]:P}:u[m]=P}}}const c=Br(t,e,r);if(c){const o=Object.keys(l);for(const d in n)o.every(u=>u!==d)&&(s[d]=t.serialize(c,n[d],r+'["'+d+'"]',a))}return s}return n}function Dt(t,e,n,r){if(!n||!t.xmlNamespace)return e;const a={[t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns"]:t.xmlNamespace};if(["Composite"].includes(t.type.name)){if(e[w])return e;{const l=Object.assign({},e);return l[w]=a,l}}const s={};return s[r.xml.xmlCharKey]=e,s[w]=a,s}function Fr(t,e){return[w,e.xml.xmlCharKey].includes(t)}function Wr(t,e,n,r,i){var a,s;const l=(a=i.xml.xmlCharKey)!==null&&a!==void 0?a:ie;he(t,e)&&(e=$t(t,e,n,"serializedName"));const c=qt(t,e,r);let o={};const d=[];for(const u of Object.keys(c)){const f=c[u],p=_e(c[u].serializedName);d.push(p[0]);const{serializedName:y,xmlName:h,xmlElementName:P}=f;let b=r;y!==""&&y!==void 0&&(b=r+"."+y);const I=f.headerCollectionPrefix;if(I){const g={};for(const x of Object.keys(n))x.startsWith(I)&&(g[x.substring(I.length)]=t.deserialize(f.type.value,n[x],b,i)),d.push(x);o[u]=g}else if(t.isXML)if(f.xmlIsAttribute&&n[w])o[u]=t.deserialize(f,n[w][h],b,i);else if(f.xmlIsMsText)n[l]!==void 0?o[u]=n[l]:typeof n=="string"&&(o[u]=n);else{const g=P||h||y;if(f.xmlIsWrapped){const x=n[h],L=(s=x==null?void 0:x[P])!==null&&s!==void 0?s:[];o[u]=t.deserialize(f,L,b,i),d.push(h)}else{const x=n[g];o[u]=t.deserialize(f,x,b,i),d.push(g)}}else{let g,x=n,L=0;for(const Z of p){if(!x)break;L++,x=x[Z]}x===null&&L<p.length&&(x=void 0),g=x;const J=e.type.polymorphicDiscriminator;J&&u===J.clientName&&g==null&&(g=e.serializedName);let Y;if(Array.isArray(n[u])&&c[u].serializedName===""){g=n[u];const Z=t.deserialize(f,g,b,i);for(const[dt,dr]of Object.entries(o))Object.prototype.hasOwnProperty.call(Z,dt)||(Z[dt]=dr);o=Z}else(g!==void 0||f.defaultValue!==void 0)&&(Y=t.deserialize(f,g,b,i),o[u]=Y)}}const m=e.type.additionalProperties;if(m){const u=f=>{for(const p in c)if(_e(c[p].serializedName)[0]===f)return!1;return!0};for(const f in n)u(f)&&(o[f]=t.deserialize(m,n[f],r+'["'+f+'"]',i))}else if(n&&!i.ignoreUnknownProperties)for(const u of Object.keys(n))o[u]===void 0&&!d.includes(u)&&!Fr(u,i)&&(o[u]=n[u]);return o}function Gr(t,e,n,r,i){const a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const s={};for(const l of Object.keys(n))s[l]=t.deserialize(a,n[l],r,i);return s}return n}function Xr(t,e,n,r,i){var a;let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),s.type.name==="Composite"&&s.type.className&&(s=(a=t.modelMappers[s.type.className])!==null&&a!==void 0?a:s);const l=[];for(let c=0;c<n.length;c++)l[c]=t.deserialize(s,n[c],`${r}[${c}]`,i);return l}return n}function Qr(t,e,n){const r=[n];for(;r.length;){const i=r.shift(),a=e===i?e:i+"."+e;if(Object.prototype.hasOwnProperty.call(t,a))return t[a];for(const[s,l]of Object.entries(t))s.startsWith(i+".")&&l.type.uberParent===i&&l.type.className&&r.push(l.type.className)}}function $t(t,e,n,r){var i;const a=he(t,e);if(a){let s=a[r];if(s){r==="serializedName"&&(s=s.replace(/\\/gi,""));const l=n[s],c=(i=e.type.uberParent)!==null&&i!==void 0?i:e.type.className;if(typeof l=="string"&&c){const o=Qr(t.modelMappers.discriminators,l,c);o&&(e=o)}}}return e}function he(t,e){return e.type.polymorphicDiscriminator||pt(t,e.type.uberParent)||pt(t,e.type.className)}function pt(t,e){return e&&t.modelMappers[e]&&t.modelMappers[e].type.polymorphicDiscriminator}const j={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"},ft=new Set(["Deserialize","Serialize","Retry","Sign"]);class ge{constructor(e){var n;this._policies=[],this._policies=(n=e==null?void 0:e.slice(0))!==null&&n!==void 0?n:[],this._orderedPolicies=void 0}addPolicy(e,n={}){if(n.phase&&n.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(n.phase&&!ft.has(n.phase))throw new Error(`Invalid phase name: ${n.phase}`);if(n.afterPhase&&!ft.has(n.afterPhase))throw new Error(`Invalid afterPhase name: ${n.afterPhase}`);this._policies.push({policy:e,options:n}),this._orderedPolicies=void 0}removePolicy(e){const n=[];return this._policies=this._policies.filter(r=>e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase?(n.push(r.policy),!1):!0),this._orderedPolicies=void 0,n}sendRequest(e,n){return this.getOrderedPolicies().reduceRight((a,s)=>l=>s.sendRequest(l,a),a=>e.sendRequest(a))(n)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new ge(this._policies)}static create(){return new ge}orderPolicies(){const e=[],n=new Map;function r(p){return{name:p,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const i=r("Serialize"),a=r("None"),s=r("Deserialize"),l=r("Retry"),c=r("Sign"),o=[i,a,s,l,c];function d(p){return p==="Retry"?l:p==="Serialize"?i:p==="Deserialize"?s:p==="Sign"?c:a}for(const p of this._policies){const y=p.policy,h=p.options,P=y.name;if(n.has(P))throw new Error("Duplicate policy names not allowed in pipeline");const b={policy:y,dependsOn:new Set,dependants:new Set};h.afterPhase&&(b.afterPhase=d(h.afterPhase),b.afterPhase.hasAfterPolicies=!0),n.set(P,b),d(h.phase).policies.add(b)}for(const p of this._policies){const{policy:y,options:h}=p,P=y.name,b=n.get(P);if(!b)throw new Error(`Missing node for policy ${P}`);if(h.afterPolicies)for(const I of h.afterPolicies){const g=n.get(I);g&&(b.dependsOn.add(g),g.dependants.add(b))}if(h.beforePolicies)for(const I of h.beforePolicies){const g=n.get(I);g&&(g.dependsOn.add(b),b.dependants.add(g))}}function m(p){p.hasRun=!0;for(const y of p.policies)if(!(y.afterPhase&&(!y.afterPhase.hasRun||y.afterPhase.policies.size))&&y.dependsOn.size===0){e.push(y.policy);for(const h of y.dependants)h.dependsOn.delete(y);n.delete(y.policy.name),p.policies.delete(y)}}function u(){for(const p of o){if(m(p),p.policies.size>0&&p!==a){a.hasRun||m(a);return}p.hasAfterPolicies&&m(a)}}let f=0;for(;n.size>0;){f++;const p=e.length;if(u(),e.length<=p&&f>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function Jr(){return ge.create()}function Yr(...t){if(t.length>0){const e=String(t[0]);e.includes(":error")?console.error(...t):e.includes(":warning")?console.warn(...t):e.includes(":info")?console.info(...t):e.includes(":verbose")?console.debug(...t):console.debug(...t)}}const yt=typeof process<"u"&&process.env&&{}.DEBUG||void 0;let Ht,qe=[],De=[];const be=[];yt&&Ge(yt);const kt=Object.assign(t=>Ut(t),{enable:Ge,enabled:Xe,disable:Zr,log:Yr});function Ge(t){Ht=t,qe=[],De=[];const e=/\*/g,n=t.split(",").map(r=>r.trim().replace(e,".*?"));for(const r of n)r.startsWith("-")?De.push(new RegExp(`^${r.substr(1)}$`)):qe.push(new RegExp(`^${r}$`));for(const r of be)r.enabled=Xe(r.namespace)}function Xe(t){if(t.endsWith("*"))return!0;for(const e of De)if(e.test(t))return!1;for(const e of qe)if(e.test(t))return!0;return!1}function Zr(){const t=Ht||"";return Ge(""),t}function Ut(t){const e=Object.assign(n,{enabled:Xe(t),destroy:ei,log:kt.log,namespace:t,extend:ti});function n(...r){e.enabled&&(r.length>0&&(r[0]=`${t} ${r[0]}`),e.log(...r))}return be.push(e),e}function ei(){const t=be.indexOf(this);return t>=0?(be.splice(t,1),!0):!1}function ti(t){const e=Ut(`${this.namespace}:${t}`);return e.log=this.log,e}const ae=kt,Lt=new Set,se=typeof process<"u"&&process.env&&{}.AZURE_LOG_LEVEL||void 0;let $e;const He=ae("azure");He.log=(...t)=>{ae.log(...t)};const Qe=["verbose","info","warning","error"];se&&(Bt(se)?ni(se):console.error(`AZURE_LOG_LEVEL set to unknown log level '${se}'; logging is not enabled. Acceptable values: ${Qe.join(", ")}.`));function ni(t){if(t&&!Bt(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${Qe.join(",")}`);$e=t;const e=[];for(const n of Lt)Vt(n)&&e.push(n.namespace);ae.enable(e.join(","))}const ht={verbose:400,info:300,warning:200,error:100};function Ne(t){const e=He.extend(t);return Kt(He,e),{error:oe(e,"error"),warning:oe(e,"warning"),info:oe(e,"info"),verbose:oe(e,"verbose")}}function Kt(t,e){e.log=(...n)=>{t.log(...n)}}function oe(t,e){const n=Object.assign(t.extend(e),{level:e});if(Kt(t,n),Vt(n)){const r=ae.disable();ae.enable(r+","+n.namespace)}return Lt.add(n),n}function Vt(t){return!!($e&&ht[t.level]<=ht[$e])}function Bt(t){return Qe.includes(t)}const G=Ne("core-rest-pipeline");class Je extends Error{constructor(e){super(e),this.name="AbortError"}}function ri(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function jt(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function Ye(t){if(jt(t)){const e=typeof t.name=="string",n=typeof t.message=="string";return e&&n}return!1}function Pe(t){if(Ye(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}function ii(){let t="";for(let e=0;e<32;e++){const n=Math.floor(Math.random()*16);e===12?t+="4":e===16?t+=n&3|8:t+=n.toString(16),(e===7||e===11||e===15||e===19)&&(t+="-")}return t}var Ee;const ai=typeof((Ee=globalThis==null?void 0:globalThis.crypto)===null||Ee===void 0?void 0:Ee.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):ii;function si(){return ai()}const ve="REDACTED",oi=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],li=["api-version"];class Ft{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:n=[]}={}){e=oi.concat(e),n=li.concat(n),this.allowedHeaderNames=new Set(e.map(r=>r.toLowerCase())),this.allowedQueryParameters=new Set(n.map(r=>r.toLowerCase()))}sanitize(e){const n=new Set;return JSON.stringify(e,(r,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if(r==="headers")return this.sanitizeHeaders(i);if(r==="url")return this.sanitizeUrl(i);if(r==="query")return this.sanitizeQuery(i);if(r==="body")return;if(r==="response")return;if(r==="operationSpec")return;if(Array.isArray(i)||jt(i)){if(n.has(i))return"[Circular]";n.add(i)}return i},2)}sanitizeHeaders(e){const n={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?n[r]=e[r]:n[r]=ve;return n}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;const n={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?n[r]=e[r]:n[r]=ve;return n}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;const n=new URL(e);if(!n.search)return e;for(const[r]of n.searchParams)this.allowedQueryParameters.has(r.toLowerCase())||n.searchParams.set(r,ve);return n.toString()}}const ci="logPolicy";function di(t={}){var e;const n=(e=t.logger)!==null&&e!==void 0?e:G.info,r=new Ft({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:ci,async sendRequest(i,a){if(!n.enabled)return a(i);n(`Request: ${r.sanitize(i)}`);const s=await a(i);return n(`Response status code: ${s.status}`),n(`Headers: ${r.sanitize(s.headers)}`),s}}}function ui(){return"x-ms-useragent"}function mi(t){var e,n,r;const i=globalThis.navigator;t.set("OS",((r=(n=(e=i==null?void 0:i.userAgentData)===null||e===void 0?void 0:e.platform)!==null&&n!==void 0?n:i==null?void 0:i.platform)!==null&&r!==void 0?r:"unknown").replace(" ",""))}const Wt="1.10.3",ke=3;function pi(t){const e=[];for(const[n,r]of t){const i=r?`${n}/${r}`:n;e.push(i)}return e.join(" ")}function fi(){return ui()}function Gt(t){const e=new Map;e.set("core-rest-pipeline",Wt),mi(e);const n=pi(e);return t?`${t} ${n}`:n}const gt=fi(),yi="userAgentPolicy";function hi(t={}){const e=Gt(t.userAgentPrefix);return{name:yi,async sendRequest(n,r){return n.headers.has(gt)||n.headers.set(gt,e),r(n)}}}const gi="The operation was aborted.";function Xt(t,e,n){return new Promise((r,i)=>{let a,s;const l=()=>i(new Je(n!=null&&n.abortErrorMsg?n==null?void 0:n.abortErrorMsg:gi)),c=()=>{n!=null&&n.abortSignal&&s&&n.abortSignal.removeEventListener("abort",s)};if(s=()=>(a&&clearTimeout(a),c(),l()),n!=null&&n.abortSignal&&n.abortSignal.aborted)return l();a=setTimeout(()=>{c(),r(e)},t),n!=null&&n.abortSignal&&n.abortSignal.addEventListener("abort",s)})}function bi(t,e){const n=t.headers.get(e);if(!n)return;const r=Number(n);if(!Number.isNaN(r))return r}const Ue="Retry-After",xi=["retry-after-ms","x-ms-retry-after-ms",Ue];function Qt(t){if(t&&[429,503].includes(t.status))try{for(const i of xi){const a=bi(t,i);if(a===0||a)return a*(i===Ue?1e3:1)}const e=t.headers.get(Ue);if(!e)return;const r=Date.parse(e)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}function Ni(t){return Number.isFinite(Qt(t))}function Pi(){return{name:"throttlingRetryStrategy",retry({response:t}){const e=Qt(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}const Si=1e3,Ti=1e3*64;function wi(t={}){var e,n;const r=(e=t.retryDelayInMs)!==null&&e!==void 0?e:Si,i=(n=t.maxRetryDelayInMs)!==null&&n!==void 0?n:Ti;let a=r;return{name:"exponentialRetryStrategy",retry({retryCount:s,response:l,responseError:c}){const o=vi(c),d=o&&t.ignoreSystemErrors,m=Ei(l),u=m&&t.ignoreHttpStatusCodes;if(l&&(Ni(l)||!m)||u||d)return{skipStrategy:!0};if(c&&!o&&!m)return{errorToThrow:c};const p=a*Math.pow(2,s),y=Math.min(i,p);return a=y/2+ri(0,y/2),{retryAfterInMs:a}}}}function Ei(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function vi(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT":!1}const bt=Ne("core-rest-pipeline retryPolicy"),Ci="retryPolicy";function Ri(t,e={maxRetries:ke}){const n=e.logger||bt;return{name:Ci,async sendRequest(r,i){var a,s;let l,c,o=-1;e:for(;;){o+=1,l=void 0,c=void 0;try{n.info(`Retry ${o}: Attempting to send request`,r.requestId),l=await i(r),n.info(`Retry ${o}: Received a response from request`,r.requestId)}catch(d){if(n.error(`Retry ${o}: Received an error from request`,r.requestId),c=d,!d||c.name!=="RestError")throw d;l=c.response}if(!((a=r.abortSignal)===null||a===void 0)&&a.aborted)throw n.error(`Retry ${o}: Request aborted.`),new Je;if(o>=((s=e.maxRetries)!==null&&s!==void 0?s:ke)){if(n.info(`Retry ${o}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(l)return l;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${o}: Processing ${t.length} retry strategies.`);t:for(const d of t){const m=d.logger||bt;m.info(`Retry ${o}: Processing retry strategy ${d.name}.`);const u=d.retry({retryCount:o,response:l,responseError:c});if(u.skipStrategy){m.info(`Retry ${o}: Skipped.`);continue t}const{errorToThrow:f,retryAfterInMs:p,redirectTo:y}=u;if(f)throw m.error(`Retry ${o}: Retry strategy ${d.name} throws error:`,f),f;if(p||p===0){m.info(`Retry ${o}: Retry strategy ${d.name} retries after ${p}`),await Xt(p,void 0,{abortSignal:r.abortSignal});continue e}if(y){m.info(`Retry ${o}: Retry strategy ${d.name} redirects to ${y}`),r.url=y;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(l)return n.info("None of the retry strategies could work with the received response. Returning it."),l}}}}const Oi="defaultRetryPolicy";function zi(t={}){var e;return{name:Oi,sendRequest:Ri([Pi(),wi(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:ke}).sendRequest}}const Ai="formDataPolicy";function Mi(){return{name:Ai,async sendRequest(t,e){if(t.formData){const n=t.formData,r=new FormData;for(const a of Object.keys(n)){const s=n[a];if(Array.isArray(s))for(const l of s)r.append(a,l);else r.append(a,s)}t.body=r,t.formData=void 0;const i=t.headers.get("Content-Type");i&&i.indexOf("application/x-www-form-urlencoded")!==-1?t.body=new URLSearchParams(r).toString():i&&i.indexOf("multipart/form-data")!==-1&&t.headers.delete("Content-Type")}return e(t)}}}const Ii="setClientRequestIdPolicy";function _i(t="x-ms-client-request-id"){return{name:Ii,async sendRequest(e,n){return e.headers.has(t)||e.headers.set(t,e.requestId),n(e)}}}const ne={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function qi(t={}){let e=new re(t.parentContext);return t.span&&(e=e.setValue(ne.span,t.span)),t.namespace&&(e=e.setValue(ne.namespace,t.namespace)),e}class re{constructor(e){this._contextMap=e instanceof re?new Map(e._contextMap):new Map}setValue(e,n){const r=new re(this);return r._contextMap.set(e,n),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const n=new re(this);return n._contextMap.delete(e),n}}function Di(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function $i(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:Di(),tracingContext:qi({parentContext:e.tracingContext})}),withContext(t,e,...n){return e(...n)}}}let Ce;function le(){return Ce||(Ce=$i()),Ce}function Jt(t){const{namespace:e,packageName:n,packageVersion:r}=t;function i(o,d,m){var u;const f=le().startSpan(o,Object.assign(Object.assign({},m),{packageName:n,packageVersion:r,tracingContext:(u=d==null?void 0:d.tracingOptions)===null||u===void 0?void 0:u.tracingContext}));let p=f.tracingContext;const y=f.span;p.getValue(ne.namespace)||(p=p.setValue(ne.namespace,e)),y.setAttribute("az.namespace",p.getValue(ne.namespace));const h=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d==null?void 0:d.tracingOptions),{tracingContext:p})});return{span:y,updatedOptions:h}}async function a(o,d,m,u){const{span:f,updatedOptions:p}=i(o,d,u);try{const y=await s(p.tracingOptions.tracingContext,()=>Promise.resolve(m(p,f)));return f.setStatus({status:"success"}),y}catch(y){throw f.setStatus({status:"error",error:y}),y}finally{f.end()}}function s(o,d,...m){return le().withContext(o,d,...m)}function l(o){return le().parseTraceparentHeader(o)}function c(o){return le().createRequestHeaders(o)}return{startSpan:i,withSpan:a,withContext:s,parseTraceparentHeader:l,createRequestHeaders:c}}const Hi={},ki=new Ft;class z extends Error{constructor(e,n={}){super(e),this.name="RestError",this.code=n.code,this.statusCode=n.statusCode,this.request=n.request,this.response=n.response,Object.setPrototypeOf(this,z.prototype)}[Hi](){return`RestError: ${this.message} 
 ${ki.sanitize(this)}`}}z.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";z.PARSE_ERROR="PARSE_ERROR";function Ui(t){return t instanceof z?!0:Ye(t)&&t.name==="RestError"}const Li="tracingPolicy";function Ki(t={}){const e=Gt(t.userAgentPrefix),n=Vi();return{name:Li,async sendRequest(r,i){var a,s;if(!n||!(!((a=r.tracingOptions)===null||a===void 0)&&a.tracingContext))return i(r);const{span:l,tracingContext:c}=(s=Bi(n,r,e))!==null&&s!==void 0?s:{};if(!l||!c)return i(r);try{const o=await n.withContext(c,i,r);return Fi(l,o),o}catch(o){throw ji(l,o),o}}}}function Vi(){try{return Jt({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Wt})}catch(t){G.warning(`Error when creating the TracingClient: ${Pe(t)}`);return}}function Bi(t,e,n){try{const{span:r,updatedOptions:i}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!r.isRecording()){r.end();return}n&&r.setAttribute("http.user_agent",n);const a=t.createRequestHeaders(i.tracingOptions.tracingContext);for(const[s,l]of Object.entries(a))e.headers.set(s,l);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(r){G.warning(`Skipping creating a tracing span due to an error: ${Pe(r)}`);return}}function ji(t,e){try{t.setStatus({status:"error",error:Ye(e)?e:void 0}),Ui(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(n){G.warning(`Skipping tracing span processing due to an error: ${Pe(n)}`)}}function Fi(t,e){try{t.setAttribute("http.status_code",e.status);const n=e.headers.get("x-ms-request-id");n&&t.setAttribute("serviceRequestId",n),t.setStatus({status:"success"}),t.end()}catch(n){G.warning(`Skipping tracing span processing due to an error: ${Pe(n)}`)}}function Wi(t){const e=Jr();return e.addPolicy(Mi()),e.addPolicy(hi(t.userAgentOptions)),e.addPolicy(_i()),e.addPolicy(zi(t.retryOptions),{phase:"Retry"}),e.addPolicy(Ki(t.userAgentOptions),{afterPhase:"Retry"}),e.addPolicy(di(t.loggingOptions),{afterPhase:"Sign"}),e}function ce(t){return t.toLowerCase()}function*Gi(t){for(const e of t.values())yield[e.name,e.value]}class Xi{constructor(e){if(this._headersMap=new Map,e)for(const n of Object.keys(e))this.set(n,e[n])}set(e,n){this._headersMap.set(ce(e),{name:e,value:String(n)})}get(e){var n;return(n=this._headersMap.get(ce(e)))===null||n===void 0?void 0:n.value}has(e){return this._headersMap.has(ce(e))}delete(e){this._headersMap.delete(ce(e))}toJSON(e={}){const n={};if(e.preserveCase)for(const r of this._headersMap.values())n[r.name]=r.value;else for(const[r,i]of this._headersMap)n[r]=i.value;return n}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Gi(this._headersMap)}}function Se(t){return new Xi(t)}function Qi(t){return t&&typeof t.pipe=="function"}function Yt(t){return!!(t&&typeof t.getReader=="function"&&typeof t.tee=="function")}function Ji(t){return(typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob}class Yi{async sendRequest(e){if(new URL(e.url).protocol!=="https:"&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await Zi(e)}catch(i){throw na(i,e)}}}async function Zi(t){const{abortController:e,abortControllerCleanup:n}=ta(t);try{const r=ra(t.headers),i=aa(t),a=await fetch(t.url,{body:i,method:t.method,headers:r,signal:e.signal,credentials:t.withCredentials?"include":"same-origin",cache:"no-store"});return Ji(t.body)&&t.onUploadProgress&&t.onUploadProgress({loadedBytes:t.body.size}),ea(a,t)}finally{n&&n()}}async function ea(t,e){var n,r;const i=ia(t),a={request:e,headers:i,status:t.status},s=Yt(t.body)?Zt(t.body,e.onDownloadProgress):t.body;if(!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((r=e.streamResponseStatusCodes)===null||r===void 0)&&r.has(a.status))if(e.enableBrowserStreams)a.browserStreamBody=s??void 0;else{const l=new Response(s);a.blobBody=l.blob()}else{const l=new Response(s);a.bodyAsText=await l.text()}return a}function ta(t){const e=new AbortController;let n,r;if(t.abortSignal){if(t.abortSignal.aborted)throw new Je("The operation was aborted.");r=i=>{i.type==="abort"&&e.abort()},t.abortSignal.addEventListener("abort",r),n=()=>{var i;r&&((i=t.abortSignal)===null||i===void 0||i.removeEventListener("abort",r))}}return t.timeout>0&&setTimeout(()=>{e.abort()},t.timeout),{abortController:e,abortControllerCleanup:n}}function na(t,e){var n;return t&&(t==null?void 0:t.name)==="AbortError"?t:new z(`Error sending request: ${t.message}`,{code:(n=t==null?void 0:t.code)!==null&&n!==void 0?n:z.REQUEST_SEND_ERROR,request:e})}function ra(t){const e=new Headers;for(const[n,r]of t)e.append(n,r);return e}function ia(t){const e=Se();for(const[n,r]of t.headers)e.set(n,r);return e}function aa(t){const e=typeof t.body=="function"?t.body():t.body;if(Qi(e))throw new Error("Node streams are not supported in browser environment.");return Yt(e)?Zt(e,t.onUploadProgress):e}function Zt(t,e){let n=0;if(oa(t))return t.pipeThrough(new TransformStream({transform(r,i){if(r===null){i.terminate();return}i.enqueue(r),n+=r.length,e&&e({loadedBytes:n})}}));{const r=t.getReader();return new ReadableStream({async pull(i){var a;const{done:s,value:l}=await r.read();if(s||!l){i.close(),r.releaseLock();return}n+=(a=l==null?void 0:l.length)!==null&&a!==void 0?a:0,i.enqueue(l),e&&e({loadedBytes:n})}})}}function sa(){return new Yi}function oa(t){return t.pipeThrough!==void 0&&self.TransformStream!==void 0}function la(){return sa()}class ca{constructor(e){var n,r,i,a,s,l,c;this.url=e.url,this.body=e.body,this.headers=(n=e.headers)!==null&&n!==void 0?n:Se(),this.method=(r=e.method)!==null&&r!==void 0?r:"GET",this.timeout=(i=e.timeout)!==null&&i!==void 0?i:0,this.formData=e.formData,this.disableKeepAlive=(a=e.disableKeepAlive)!==null&&a!==void 0?a:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(s=e.withCredentials)!==null&&s!==void 0?s:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||si(),this.allowInsecureConnection=(l=e.allowInsecureConnection)!==null&&l!==void 0?l:!1,this.enableBrowserStreams=(c=e.enableBrowserStreams)!==null&&c!==void 0?c:!1}}function Ze(t){return new ca(t)}const da={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function ua(t,e,n){async function r(){if(Date.now()<n)try{return await t()}catch{return null}else{const a=await t();if(a===null)throw new Error("Failed to refresh access token.");return a}}let i=await r();for(;i===null;)await Xt(e),i=await r();return i}function ma(t,e){let n=null,r=null,i;const a=Object.assign(Object.assign({},da),e),s={get isRefreshing(){return n!==null},get shouldRefresh(){var c;return!s.isRefreshing&&((c=r==null?void 0:r.expiresOnTimestamp)!==null&&c!==void 0?c:0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return r===null||r.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function l(c,o){var d;return s.isRefreshing||(n=ua(()=>t.getToken(c,o),a.retryIntervalInMs,(d=r==null?void 0:r.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(u=>(n=null,r=u,i=o.tenantId,r)).catch(u=>{throw n=null,r=null,i=void 0,u})),n}return async(c,o)=>i!==o.tenantId||!!o.claims||s.mustRefresh?l(c,o):(s.shouldRefresh&&l(c,o),r)}const pa="bearerTokenAuthenticationPolicy";async function fa(t){const{scopes:e,getAccessToken:n,request:r}=t,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},a=await n(e,i);a&&t.request.headers.set("Authorization",`Bearer ${a.token}`)}function ya(t){const e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function en(t){var e;const{credential:n,scopes:r,challengeCallbacks:i}=t,a=t.logger||G,s=Object.assign({authorizeRequest:(e=i==null?void 0:i.authorizeRequest)!==null&&e!==void 0?e:fa,authorizeRequestOnChallenge:i==null?void 0:i.authorizeRequestOnChallenge},i),l=n?ma(n):()=>Promise.resolve(null);return{name:pa,async sendRequest(c,o){if(!c.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await s.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:c,getAccessToken:l,logger:a});let d,m;try{d=await o(c)}catch(u){m=u,d=u.response}if(s.authorizeRequestOnChallenge&&(d==null?void 0:d.status)===401&&ya(d)&&await s.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:c,response:d,getAccessToken:l,logger:a}))return o(c);if(m)throw m;return d}}}function W(t,e,n){let r=e.parameterPath;const i=e.mapper;let a;if(typeof r=="string"&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)a=i.defaultValue;else{let s=xt(t,r);!s.propertyFound&&n&&(s=xt(n,r));let l=!1;s.propertyFound||(l=i.required||r[0]==="options"&&r.length===2),a=l?i.defaultValue:s.propertyValue}}else{i.required&&(a={});for(const s in r){const l=i.type.modelProperties[s],c=r[s],o=W(t,{parameterPath:c,mapper:l},n);o!==void 0&&(a||(a={}),a[s]=o)}}return a}function xt(t,e){const n={propertyFound:!1};let r=0;for(;r<e.length;++r){const i=e[r];if(t&&i in t)t=t[i];else break}return r===e.length&&(n.propertyValue=t,n.propertyFound=!0),n}const Nt=new WeakMap,tn=Symbol.for("@azure/core-client original request");function ha(t){return tn in t}function X(t){if(ha(t))return X(t[tn]);let e=Nt.get(t);return e||(e={},Nt.set(t,e)),e}const ga=["application/json","text/json"],ba=["application/xml","application/atom+xml"],xa="deserializationPolicy";function Na(t={}){var e,n,r,i,a,s,l;const c=(n=(e=t.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&n!==void 0?n:ga,o=(i=(r=t.expectedContentTypes)===null||r===void 0?void 0:r.xml)!==null&&i!==void 0?i:ba,d=t.parseXML,m=t.serializerOptions,u={xml:{rootName:(a=m==null?void 0:m.xml.rootName)!==null&&a!==void 0?a:"",includeRoot:(s=m==null?void 0:m.xml.includeRoot)!==null&&s!==void 0?s:!1,xmlCharKey:(l=m==null?void 0:m.xml.xmlCharKey)!==null&&l!==void 0?l:ie}};return{name:xa,async sendRequest(f,p){const y=await p(f);return Ta(c,o,y,u,d)}}}function Pa(t){let e;const n=t.request,r=X(n),i=r==null?void 0:r.operationSpec;return i&&(r!=null&&r.operationResponseGetter?e=r==null?void 0:r.operationResponseGetter(i,t):e=i.responses[t.status]),e}function Sa(t){const e=t.request,n=X(e),r=n==null?void 0:n.shouldDeserialize;let i;return r===void 0?i=!0:typeof r=="boolean"?i=r:i=r(t),i}async function Ta(t,e,n,r,i){const a=await va(t,e,n,r,i);if(!Sa(a))return a;const s=X(a.request),l=s==null?void 0:s.operationSpec;if(!l||!l.responses)return a;const c=Pa(a),{error:o,shouldReturnResponse:d}=Ea(a,l,c,r);if(o)throw o;if(d)return a;if(c){if(c.bodyMapper){let m=a.parsedBody;l.isXML&&c.bodyMapper.type.name===j.Sequence&&(m=typeof m=="object"?m[c.bodyMapper.xmlElementName]:[]);try{a.parsedBody=l.serializer.deserialize(c.bodyMapper,m,"operationRes.parsedBody",r)}catch(u){throw new z(`Error ${u} occurred in deserializing the responseBody - ${a.bodyAsText}`,{statusCode:a.status,request:a.request,response:a})}}else l.httpMethod==="HEAD"&&(a.parsedBody=n.status>=200&&n.status<300);c.headersMapper&&(a.parsedHeaders=l.serializer.deserialize(c.headersMapper,a.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return a}function wa(t){const e=Object.keys(t.responses);return e.length===0||e.length===1&&e[0]==="default"}function Ea(t,e,n,r){var i;const a=200<=t.status&&t.status<300;if(wa(e)?a:!!n)if(n){if(!n.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};const l=n??e.responses.default,c=!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status)?`Unexpected status code: ${t.status}`:t.bodyAsText,o=new z(c,{statusCode:t.status,request:t.request,response:t});if(!l)throw o;const d=l.bodyMapper,m=l.headersMapper;try{if(t.parsedBody){const u=t.parsedBody;let f;if(d){let y=u;if(e.isXML&&d.type.name===j.Sequence){y=[];const h=d.xmlElementName;typeof u=="object"&&h&&(y=u[h])}f=e.serializer.deserialize(d,y,"error.response.parsedBody",r)}const p=u.error||f||u;o.code=p.code,p.message&&(o.message=p.message),d&&(o.response.parsedBody=f)}t.headers&&m&&(o.response.parsedHeaders=e.serializer.deserialize(m,t.headers.toJSON(),"operationRes.parsedHeaders"))}catch(u){o.message=`Error "${u.message}" occurred in deserializing the responseBody - "${t.bodyAsText}" for the default response.`}return{error:o,shouldReturnResponse:!1}}async function va(t,e,n,r,i){var a;if(!(!((a=n.request.streamResponseStatusCodes)===null||a===void 0)&&a.has(n.status))&&n.bodyAsText){const s=n.bodyAsText,l=n.headers.get("Content-Type")||"",c=l?l.split(";").map(o=>o.toLowerCase()):[];try{if(c.length===0||c.some(o=>t.indexOf(o)!==-1))return n.parsedBody=JSON.parse(s),n;if(c.some(o=>e.indexOf(o)!==-1)){if(!i)throw new Error("Parsing XML not supported.");const o=await i(s,r.xml);return n.parsedBody=o,n}}catch(o){const d=`Error "${o}" occurred while parsing the response body - ${n.bodyAsText}.`,m=o.code||z.PARSE_ERROR;throw new z(d,{code:m,statusCode:n.status,request:n.request,response:n})}}return n}function Ca(t){const e=new Set;for(const n in t.responses){const r=t.responses[n];r.bodyMapper&&r.bodyMapper.type.name===j.Stream&&e.add(Number(n))}return e}function H(t){const{parameterPath:e,mapper:n}=t;let r;return typeof e=="string"?r=e:Array.isArray(e)?r=e.join("."):r=n.serializedName,r}const nn="serializationPolicy";function rn(t={}){const e=t.stringifyXML;return{name:nn,async sendRequest(n,r){const i=X(n),a=i==null?void 0:i.operationSpec,s=i==null?void 0:i.operationArguments;return a&&s&&(Ra(n,s,a),Oa(n,s,a,e)),r(n)}}}function Ra(t,e,n){var r,i;if(n.headerParameters)for(const s of n.headerParameters){let l=W(e,s);if(l!=null||s.mapper.required){l=n.serializer.serialize(s.mapper,l,H(s));const c=s.mapper.headerCollectionPrefix;if(c)for(const o of Object.keys(l))t.headers.set(c+o,l[o]);else t.headers.set(s.mapper.serializedName||H(s),l)}}const a=(i=(r=e.options)===null||r===void 0?void 0:r.requestOptions)===null||i===void 0?void 0:i.customHeaders;if(a)for(const s of Object.keys(a))t.headers.set(s,a[s])}function Oa(t,e,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,a,s,l,c;const o=(i=e.options)===null||i===void 0?void 0:i.serializerOptions,d={xml:{rootName:(a=o==null?void 0:o.xml.rootName)!==null&&a!==void 0?a:"",includeRoot:(s=o==null?void 0:o.xml.includeRoot)!==null&&s!==void 0?s:!1,xmlCharKey:(l=o==null?void 0:o.xml.xmlCharKey)!==null&&l!==void 0?l:ie}},m=d.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=W(e,n.requestBody);const u=n.requestBody.mapper,{required:f,serializedName:p,xmlName:y,xmlElementName:h,xmlNamespace:P,xmlNamespacePrefix:b,nullable:I}=u,g=u.type.name;try{if(t.body!==void 0&&t.body!==null||I&&t.body===null||f){const x=H(n.requestBody);t.body=n.serializer.serialize(u,t.body,x,d);const L=g===j.Stream;if(n.isXML){const J=b?`xmlns:${b}`:"xmlns",Y=za(P,J,g,t.body,d);g===j.Sequence?t.body=r(Aa(Y,h||y||p,J,P),{rootName:y||p,xmlCharKey:m}):L||(t.body=r(Y,{rootName:y||p,xmlCharKey:m}))}else{if(g===j.String&&(!((c=n.contentType)===null||c===void 0)&&c.match("text/plain")||n.mediaType==="text"))return;L||(t.body=JSON.stringify(t.body))}}}catch(x){throw new Error(`Error "${x.message}" occurred in serializing the payload - ${JSON.stringify(p,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const u of n.formDataParameters){const f=W(e,u);if(f!=null){const p=u.mapper.serializedName||H(u);t.formData[p]=n.serializer.serialize(u.mapper,f,H(u),d)}}}}function za(t,e,n,r,i){if(t&&!["Composite","Sequence","Dictionary"].includes(n)){const a={};return a[i.xml.xmlCharKey]=r,a[w]={[e]:t},a}return r}function Aa(t,e,n,r){if(Array.isArray(t)||(t=[t]),!n||!r)return{[e]:t};const i={[e]:t};return i[w]={[n]:r},i}function Ma(t={}){const e=Wi(t??{});return t.credentialOptions&&e.addPolicy(en({credential:t.credentialOptions.credential,scopes:t.credentialOptions.credentialScopes})),e.addPolicy(rn(t.serializationOptions),{phase:"Serialize"}),e.addPolicy(Na(t.deserializationOptions),{phase:"Deserialize"}),e}let Re;function Ia(){return Re||(Re=la()),Re}const _a={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function qa(t,e,n,r){const i=Da(e,n,r);let a=!1,s=Pt(t,i);if(e.path){let o=Pt(e.path,i);e.path==="/{nextLink}"&&o.startsWith("/")&&(o=o.substring(1)),$a(o)?(s=o,a=!0):s=Ha(s,o)}const{queryParams:l,sequenceParams:c}=ka(e,n,r);return s=La(s,l,c,a),s}function Pt(t,e){let n=t;for(const[r,i]of e)n=n.split(r).join(i);return n}function Da(t,e,n){var r;const i=new Map;if(!((r=t.urlParameters)===null||r===void 0)&&r.length)for(const a of t.urlParameters){let s=W(e,a,n);const l=H(a);s=t.serializer.serialize(a.mapper,s,l),a.skipEncoding||(s=encodeURIComponent(s)),i.set(`{${a.mapper.serializedName||l}}`,s)}return i}function $a(t){return t.includes("://")}function Ha(t,e){if(!e)return t;const n=new URL(t);let r=n.pathname;r.endsWith("/")||(r=`${r}/`),e.startsWith("/")&&(e=e.substring(1));const i=e.indexOf("?");if(i!==-1){const a=e.substring(0,i),s=e.substring(i+1);r=r+a,s&&(n.search=n.search?`${n.search}&${s}`:s)}else r=r+e;return n.pathname=r,n.toString()}function ka(t,e,n){var r;const i=new Map,a=new Set;if(!((r=t.queryParameters)===null||r===void 0)&&r.length)for(const s of t.queryParameters){s.mapper.type.name==="Sequence"&&s.mapper.serializedName&&a.add(s.mapper.serializedName);let l=W(e,s,n);if(l!=null||s.mapper.required){l=t.serializer.serialize(s.mapper,l,H(s));const c=s.collectionFormat?_a[s.collectionFormat]:"";if(Array.isArray(l)&&(l=l.map(o=>o??"")),s.collectionFormat==="Multi"&&l.length===0)continue;Array.isArray(l)&&(s.collectionFormat==="SSV"||s.collectionFormat==="TSV")&&(l=l.join(c)),s.skipEncoding||(Array.isArray(l)?l=l.map(o=>encodeURIComponent(o)):l=encodeURIComponent(l)),Array.isArray(l)&&(s.collectionFormat==="CSV"||s.collectionFormat==="Pipes")&&(l=l.join(c)),i.set(s.mapper.serializedName||H(s),l)}}return{queryParams:i,sequenceParams:a}}function Ua(t){const e=new Map;if(!t||t[0]!=="?")return e;t=t.slice(1);const n=t.split("&");for(const r of n){const[i,a]=r.split("=",2),s=e.get(i);s?Array.isArray(s)?s.push(a):e.set(i,[s,a]):e.set(i,a)}return e}function La(t,e,n,r=!1){if(e.size===0)return t;const i=new URL(t),a=Ua(i.search);for(const[l,c]of e){const o=a.get(l);if(Array.isArray(o))if(Array.isArray(c)){o.push(...c);const d=new Set(o);a.set(l,Array.from(d))}else o.push(c);else o?(Array.isArray(c)?c.unshift(o):n.has(l)&&a.set(l,[o,c]),r||a.set(l,c)):a.set(l,c)}const s=[];for(const[l,c]of a)if(typeof c=="string")s.push(`${l}=${c}`);else if(Array.isArray(c))for(const o of c)s.push(`${l}=${o}`);else s.push(`${l}=${c}`);return i.search=s.length?`?${s.join("&")}`:"",i.toString()}const Ka=Ne("core-client");class Va{constructor(e={}){var n,r;if(this._requestContentType=e.requestContentType,this._endpoint=(n=e.endpoint)!==null&&n!==void 0?n:e.baseUri,e.baseUri&&Ka.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||Ia(),this.pipeline=e.pipeline||Ba(e),!((r=e.additionalPolicies)===null||r===void 0)&&r.length)for(const{policy:i,position:a}of e.additionalPolicies){const s=a==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(i,{afterPhase:s})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,n){const r=n.baseUrl||this._endpoint;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=qa(r,n,e,this),a=Ze({url:i});a.method=n.httpMethod;const s=X(a);s.operationSpec=n,s.operationArguments=e;const l=n.contentType||this._requestContentType;l&&n.requestBody&&a.headers.set("Content-Type",l);const c=e.options;if(c){const o=c.requestOptions;o&&(o.timeout&&(a.timeout=o.timeout),o.onUploadProgress&&(a.onUploadProgress=o.onUploadProgress),o.onDownloadProgress&&(a.onDownloadProgress=o.onDownloadProgress),o.shouldDeserialize!==void 0&&(s.shouldDeserialize=o.shouldDeserialize),o.allowInsecureConnection&&(a.allowInsecureConnection=!0)),c.abortSignal&&(a.abortSignal=c.abortSignal),c.tracingOptions&&(a.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(a.allowInsecureConnection=!0),a.streamResponseStatusCodes===void 0&&(a.streamResponseStatusCodes=Ca(n));try{const o=await this.sendRequest(a),d=mt(o,n.responses[o.status]);return c!=null&&c.onResponse&&c.onResponse(o,d),d}catch(o){if(typeof o=="object"&&(o!=null&&o.response)){const d=o.response,m=mt(d,n.responses[o.statusCode]||n.responses.default);o.details=m,c!=null&&c.onResponse&&c.onResponse(d,m,o)}throw o}}}function Ba(t){const e=ja(t),n=t.credential&&e?{credentialScopes:e,credential:t.credential}:void 0;return Ma(Object.assign(Object.assign({},t),{credentialOptions:n}))}function ja(t){if(t.credentialScopes){const e=t.credentialScopes;return Array.isArray(e)?e.map(n=>new URL(n).toString()):new URL(e).toString()}if(t.endpoint)return`${t.endpoint}/.default`;if(t.baseUri)return`${t.baseUri}/.default`;if(t.credential&&!t.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}const an={DefaultScope:"/.default",HeaderConstants:{AUTHORIZATION:"authorization"}},Fa=async t=>{const e=Ja(t.request),n=Xa(t.response);if(n){const r=Qa(n),i=Ga(t,r),a=Wa(r),s=await t.getAccessToken(i,Object.assign(Object.assign({},e),{tenantId:a}));return s?(t.request.headers.set(an.HeaderConstants.AUTHORIZATION,`Bearer ${s.token}`),!0):!1}return!1};function Wa(t){return new URL(t.authorization_uri).pathname.split("/")[1]}function Ga(t,e){if(!e.resource_uri)return t.scopes;const n=new URL(e.resource_uri);return n.pathname=an.DefaultScope,[n.toString()]}function Xa(t){const e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function Qa(t){return`${t.slice(7).trim()} `.split(" ").filter(i=>i).map(i=>(([a,s])=>({[a]:s}))(i.trim().split("="))).reduce((i,a)=>Object.assign(Object.assign({},i),a),{})}function Ja(t){return{abortSignal:t.abortSignal,requestOptions:{timeout:t.timeout},tracingOptions:t.tracingOptions}}const sn={serializedName:"TableQueryResponse",type:{name:"Composite",className:"TableQueryResponse",modelProperties:{odataMetadata:{serializedName:"odata\\.metadata",xmlName:"odata\\.metadata",type:{name:"String"}},value:{serializedName:"value",xmlName:"value",xmlElementName:"TableResponseProperties",type:{name:"Sequence",element:{type:{name:"Composite",className:"TableResponseProperties"}}}}}}},on={serializedName:"TableResponseProperties",type:{name:"Composite",className:"TableResponseProperties",modelProperties:{name:{serializedName:"TableName",xmlName:"TableName",type:{name:"String"}},odataType:{serializedName:"odata\\.type",xmlName:"odata\\.type",type:{name:"String"}},odataId:{serializedName:"odata\\.id",xmlName:"odata\\.id",type:{name:"String"}},odataEditLink:{serializedName:"odata\\.editLink",xmlName:"odata\\.editLink",type:{name:"String"}}}}},E={serializedName:"TableServiceError",type:{name:"Composite",className:"TableServiceError",modelProperties:{odataError:{serializedName:"odata\\.error",xmlName:"odata\\.error",type:{name:"Composite",className:"TableServiceErrorOdataError"}}}}},Ya={serializedName:"TableServiceErrorOdataError",type:{name:"Composite",className:"TableServiceErrorOdataError",modelProperties:{code:{serializedName:"code",xmlName:"code",type:{name:"String"}},message:{serializedName:"message",xmlName:"message",type:{name:"Composite",className:"TableServiceErrorOdataErrorMessage"}}}}},Za={serializedName:"TableServiceErrorOdataErrorMessage",type:{name:"Composite",className:"TableServiceErrorOdataErrorMessage",modelProperties:{lang:{serializedName:"lang",xmlName:"lang",type:{name:"String"}},value:{serializedName:"value",xmlName:"value",type:{name:"String"}}}}},ln={serializedName:"TableProperties",type:{name:"Composite",className:"TableProperties",modelProperties:{name:{serializedName:"TableName",xmlName:"TableName",type:{name:"String"}}}}},cn={serializedName:"TableEntityQueryResponse",type:{name:"Composite",className:"TableEntityQueryResponse",modelProperties:{odataMetadata:{serializedName:"odata\\.metadata",xmlName:"odata\\.metadata",type:{name:"String"}},value:{serializedName:"value",xmlName:"value",xmlElementName:"TableEntityProperties",type:{name:"Sequence",element:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}}}}},es={serializedName:"SignedIdentifier",xmlName:"SignedIdentifier",type:{name:"Composite",className:"SignedIdentifier",modelProperties:{id:{serializedName:"Id",required:!0,xmlName:"Id",type:{name:"String"}},accessPolicy:{serializedName:"AccessPolicy",xmlName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy"}}}}},ts={serializedName:"AccessPolicy",xmlName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy",modelProperties:{start:{serializedName:"Start",xmlName:"Start",type:{name:"String"}},expiry:{serializedName:"Expiry",xmlName:"Expiry",type:{name:"String"}},permission:{serializedName:"Permission",xmlName:"Permission",type:{name:"String"}}}}},et={serializedName:"TableServiceProperties",xmlName:"StorageServiceProperties",type:{name:"Composite",className:"TableServiceProperties",modelProperties:{logging:{serializedName:"Logging",xmlName:"Logging",type:{name:"Composite",className:"Logging"}},hourMetrics:{serializedName:"HourMetrics",xmlName:"HourMetrics",type:{name:"Composite",className:"Metrics"}},minuteMetrics:{serializedName:"MinuteMetrics",xmlName:"MinuteMetrics",type:{name:"Composite",className:"Metrics"}},cors:{serializedName:"Cors",xmlName:"Cors",xmlIsWrapped:!0,xmlElementName:"CorsRule",type:{name:"Sequence",element:{type:{name:"Composite",className:"CorsRule"}}}}}}},ns={serializedName:"Logging",xmlName:"Logging",type:{name:"Composite",className:"Logging",modelProperties:{version:{serializedName:"Version",required:!0,xmlName:"Version",type:{name:"String"}},delete:{serializedName:"Delete",required:!0,xmlName:"Delete",type:{name:"Boolean"}},read:{serializedName:"Read",required:!0,xmlName:"Read",type:{name:"Boolean"}},write:{serializedName:"Write",required:!0,xmlName:"Write",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},rs={serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy",modelProperties:{enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},days:{constraints:{InclusiveMinimum:1},serializedName:"Days",xmlName:"Days",type:{name:"Number"}}}}},is={serializedName:"Metrics",type:{name:"Composite",className:"Metrics",modelProperties:{version:{serializedName:"Version",xmlName:"Version",type:{name:"String"}},enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},includeAPIs:{serializedName:"IncludeAPIs",xmlName:"IncludeAPIs",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},as={serializedName:"CorsRule",xmlName:"CorsRule",type:{name:"Composite",className:"CorsRule",modelProperties:{allowedOrigins:{serializedName:"AllowedOrigins",required:!0,xmlName:"AllowedOrigins",type:{name:"String"}},allowedMethods:{serializedName:"AllowedMethods",required:!0,xmlName:"AllowedMethods",type:{name:"String"}},allowedHeaders:{serializedName:"AllowedHeaders",required:!0,xmlName:"AllowedHeaders",type:{name:"String"}},exposedHeaders:{serializedName:"ExposedHeaders",required:!0,xmlName:"ExposedHeaders",type:{name:"String"}},maxAgeInSeconds:{constraints:{InclusiveMinimum:0},serializedName:"MaxAgeInSeconds",required:!0,xmlName:"MaxAgeInSeconds",type:{name:"Number"}}}}},dn={serializedName:"TableServiceStats",xmlName:"StorageServiceStats",type:{name:"Composite",className:"TableServiceStats",modelProperties:{geoReplication:{serializedName:"GeoReplication",xmlName:"GeoReplication",type:{name:"Composite",className:"GeoReplication"}}}}},ss={serializedName:"GeoReplication",xmlName:"GeoReplication",type:{name:"Composite",className:"GeoReplication",modelProperties:{status:{serializedName:"Status",required:!0,xmlName:"Status",type:{name:"String"}},lastSyncTime:{serializedName:"LastSyncTime",required:!0,xmlName:"LastSyncTime",type:{name:"DateTimeRfc1123"}}}}},un={serializedName:"TableResponse",type:{name:"Composite",className:"TableResponse",modelProperties:Object.assign(Object.assign({},on.type.modelProperties),{odataMetadata:{serializedName:"odata\\.metadata",xmlName:"odata\\.metadata",type:{name:"String"}}})}},mn={serializedName:"Table_queryHeaders",type:{name:"Composite",className:"TableQueryHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},xMsContinuationNextTableName:{serializedName:"x-ms-continuation-nexttablename",xmlName:"x-ms-continuation-nexttablename",type:{name:"String"}}}}},pn={serializedName:"Table_queryExceptionHeaders",type:{name:"Composite",className:"TableQueryExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Le={serializedName:"Table_createHeaders",type:{name:"Composite",className:"TableCreateHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},preferenceApplied:{serializedName:"preference-applied",xmlName:"preference-applied",type:{name:"String"}}}}},fn={serializedName:"Table_createExceptionHeaders",type:{name:"Composite",className:"TableCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yn={serializedName:"Table_deleteHeaders",type:{name:"Composite",className:"TableDeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},hn={serializedName:"Table_deleteExceptionHeaders",type:{name:"Composite",className:"TableDeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gn={serializedName:"Table_queryEntitiesHeaders",type:{name:"Composite",className:"TableQueryEntitiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},xMsContinuationNextPartitionKey:{serializedName:"x-ms-continuation-nextpartitionkey",xmlName:"x-ms-continuation-nextpartitionkey",type:{name:"String"}},xMsContinuationNextRowKey:{serializedName:"x-ms-continuation-nextrowkey",xmlName:"x-ms-continuation-nextrowkey",type:{name:"String"}}}}},bn={serializedName:"Table_queryEntitiesExceptionHeaders",type:{name:"Composite",className:"TableQueryEntitiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},xn={serializedName:"Table_queryEntitiesWithPartitionAndRowKeyHeaders",type:{name:"Composite",className:"TableQueryEntitiesWithPartitionAndRowKeyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},xMsContinuationNextPartitionKey:{serializedName:"x-ms-continuation-nextpartitionkey",xmlName:"x-ms-continuation-nextpartitionkey",type:{name:"String"}},xMsContinuationNextRowKey:{serializedName:"x-ms-continuation-nextrowkey",xmlName:"x-ms-continuation-nextrowkey",type:{name:"String"}}}}},Nn={serializedName:"Table_queryEntitiesWithPartitionAndRowKeyExceptionHeaders",type:{name:"Composite",className:"TableQueryEntitiesWithPartitionAndRowKeyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Pn={serializedName:"Table_updateEntityHeaders",type:{name:"Composite",className:"TableUpdateEntityHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}}}}},Sn={serializedName:"Table_updateEntityExceptionHeaders",type:{name:"Composite",className:"TableUpdateEntityExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Tn={serializedName:"Table_mergeEntityHeaders",type:{name:"Composite",className:"TableMergeEntityHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}}}}},wn={serializedName:"Table_mergeEntityExceptionHeaders",type:{name:"Composite",className:"TableMergeEntityExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},En={serializedName:"Table_deleteEntityHeaders",type:{name:"Composite",className:"TableDeleteEntityHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},vn={serializedName:"Table_deleteEntityExceptionHeaders",type:{name:"Composite",className:"TableDeleteEntityExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Ke={serializedName:"Table_insertEntityHeaders",type:{name:"Composite",className:"TableInsertEntityHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},preferenceApplied:{serializedName:"preference-applied",xmlName:"preference-applied",type:{name:"String"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}}}}},Cn={serializedName:"Table_insertEntityExceptionHeaders",type:{name:"Composite",className:"TableInsertEntityExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Rn={serializedName:"Table_getAccessPolicyHeaders",type:{name:"Composite",className:"TableGetAccessPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},On={serializedName:"Table_getAccessPolicyExceptionHeaders",type:{name:"Composite",className:"TableGetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zn={serializedName:"Table_setAccessPolicyHeaders",type:{name:"Composite",className:"TableSetAccessPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},An={serializedName:"Table_setAccessPolicyExceptionHeaders",type:{name:"Composite",className:"TableSetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Mn={serializedName:"Service_setPropertiesHeaders",type:{name:"Composite",className:"ServiceSetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}}}}},In={serializedName:"Service_setPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceSetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_n={serializedName:"Service_getPropertiesHeaders",type:{name:"Composite",className:"ServiceGetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}}}}},qn={serializedName:"Service_getPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Dn={serializedName:"Service_getStatisticsHeaders",type:{name:"Composite",className:"ServiceGetStatisticsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},$n={serializedName:"Service_getStatisticsExceptionHeaders",type:{name:"Composite",className:"ServiceGetStatisticsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},tt=Object.freeze(Object.defineProperty({__proto__:null,AccessPolicy:ts,CorsRule:as,GeoReplication:ss,Logging:ns,Metrics:is,RetentionPolicy:rs,ServiceGetPropertiesExceptionHeaders:qn,ServiceGetPropertiesHeaders:_n,ServiceGetStatisticsExceptionHeaders:$n,ServiceGetStatisticsHeaders:Dn,ServiceSetPropertiesExceptionHeaders:In,ServiceSetPropertiesHeaders:Mn,SignedIdentifier:es,TableCreateExceptionHeaders:fn,TableCreateHeaders:Le,TableDeleteEntityExceptionHeaders:vn,TableDeleteEntityHeaders:En,TableDeleteExceptionHeaders:hn,TableDeleteHeaders:yn,TableEntityQueryResponse:cn,TableGetAccessPolicyExceptionHeaders:On,TableGetAccessPolicyHeaders:Rn,TableInsertEntityExceptionHeaders:Cn,TableInsertEntityHeaders:Ke,TableMergeEntityExceptionHeaders:wn,TableMergeEntityHeaders:Tn,TableProperties:ln,TableQueryEntitiesExceptionHeaders:bn,TableQueryEntitiesHeaders:gn,TableQueryEntitiesWithPartitionAndRowKeyExceptionHeaders:Nn,TableQueryEntitiesWithPartitionAndRowKeyHeaders:xn,TableQueryExceptionHeaders:pn,TableQueryHeaders:mn,TableQueryResponse:sn,TableResponse:un,TableResponseProperties:on,TableServiceError:E,TableServiceErrorOdataError:Ya,TableServiceErrorOdataErrorMessage:Za,TableServiceProperties:et,TableServiceStats:dn,TableSetAccessPolicyExceptionHeaders:An,TableSetAccessPolicyHeaders:zn,TableUpdateEntityExceptionHeaders:Sn,TableUpdateEntityHeaders:Pn},Symbol.toStringTag,{value:"Module"})),Q={parameterPath:"accept",mapper:{defaultValue:"application/json;odata=minimalmetadata",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},v={parameterPath:"url",mapper:{serializedName:"url",required:!0,xmlName:"url",type:{name:"String"}},skipEncoding:!0},C={parameterPath:"version",mapper:{defaultValue:"2019-02-02",isConstant:!0,serializedName:"x-ms-version",type:{name:"String"}}},R={parameterPath:["options","requestId"],mapper:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}}},k={parameterPath:"dataServiceVersion",mapper:{defaultValue:"3.0",isConstant:!0,serializedName:"DataServiceVersion",type:{name:"String"}}},U={parameterPath:["options","queryOptions","format"],mapper:{serializedName:"$format",xmlName:"$format",type:{name:"String"}}},Hn={parameterPath:["options","queryOptions","top"],mapper:{constraints:{InclusiveMinimum:0},serializedName:"$top",xmlName:"$top",type:{name:"Number"}}},nt={parameterPath:["options","queryOptions","select"],mapper:{serializedName:"$select",xmlName:"$select",type:{name:"String"}}},rt={parameterPath:["options","queryOptions","filter"],mapper:{serializedName:"$filter",xmlName:"$filter",type:{name:"String"}}},os={parameterPath:["options","nextTableName"],mapper:{serializedName:"NextTableName",xmlName:"NextTableName",type:{name:"String"}}},kn={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json;odata=nometadata",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},ls={parameterPath:"tableProperties",mapper:ln},Un={parameterPath:["options","responsePreference"],mapper:{serializedName:"Prefer",xmlName:"Prefer",type:{name:"String"}}},it={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},_={parameterPath:"table",mapper:{serializedName:"table",required:!0,xmlName:"table",type:{name:"String"}}},M={parameterPath:["options","timeout"],mapper:{constraints:{InclusiveMinimum:0},serializedName:"timeout",xmlName:"timeout",type:{name:"Number"}}},cs={parameterPath:["options","nextPartitionKey"],mapper:{serializedName:"NextPartitionKey",xmlName:"NextPartitionKey",type:{name:"String"}}},ds={parameterPath:["options","nextRowKey"],mapper:{serializedName:"NextRowKey",xmlName:"NextRowKey",type:{name:"String"}}},Te={parameterPath:"partitionKey",mapper:{serializedName:"partitionKey",required:!0,xmlName:"partitionKey",type:{name:"String"}}},we={parameterPath:"rowKey",mapper:{serializedName:"rowKey",required:!0,xmlName:"rowKey",type:{name:"String"}}},Ln={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},at={parameterPath:["options","tableEntityProperties"],mapper:{serializedName:"tableEntityProperties",xmlName:"tableEntityProperties",type:{name:"Dictionary",value:{type:{name:"any"}}}}},Kn={parameterPath:["options","ifMatch"],mapper:{serializedName:"If-Match",xmlName:"If-Match",type:{name:"String"}}},us={parameterPath:"ifMatch",mapper:{serializedName:"If-Match",required:!0,xmlName:"If-Match",type:{name:"String"}}},st={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Vn={parameterPath:"comp",mapper:{defaultValue:"acl",isConstant:!0,serializedName:"comp",type:{name:"String"}}},Bn={parameterPath:["options","contentType"],mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},ms={parameterPath:["options","tableAcl"],mapper:{serializedName:"tableAcl",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier",type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}}}},jn={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},ps={parameterPath:"tableServiceProperties",mapper:et},ot={parameterPath:"restype",mapper:{defaultValue:"service",isConstant:!0,serializedName:"restype",type:{name:"String"}}},Fn={parameterPath:"comp",mapper:{defaultValue:"properties",isConstant:!0,serializedName:"comp",type:{name:"String"}}},fs={parameterPath:"comp",mapper:{defaultValue:"stats",isConstant:!0,serializedName:"comp",type:{name:"String"}}};class ys{constructor(e){this.client=e}query(e){return this.client.sendOperationRequest({options:e},hs)}create(e,n){return this.client.sendOperationRequest({tableProperties:e,options:n},gs)}delete(e,n){return this.client.sendOperationRequest({table:e,options:n},bs)}queryEntities(e,n){return this.client.sendOperationRequest({table:e,options:n},xs)}queryEntitiesWithPartitionAndRowKey(e,n,r,i){return this.client.sendOperationRequest({table:e,partitionKey:n,rowKey:r,options:i},Ns)}updateEntity(e,n,r,i){return this.client.sendOperationRequest({table:e,partitionKey:n,rowKey:r,options:i},Ps)}mergeEntity(e,n,r,i){return this.client.sendOperationRequest({table:e,partitionKey:n,rowKey:r,options:i},Ss)}deleteEntity(e,n,r,i,a){return this.client.sendOperationRequest({table:e,partitionKey:n,rowKey:r,ifMatch:i,options:a},Ts)}insertEntity(e,n){return this.client.sendOperationRequest({table:e,options:n},ws)}getAccessPolicy(e,n){return this.client.sendOperationRequest({table:e,options:n},Es)}setAccessPolicy(e,n){return this.client.sendOperationRequest({table:e,options:n},vs)}}const Wn=We(tt,!0),q=We(tt,!1),hs={path:"/Tables",httpMethod:"GET",responses:{200:{bodyMapper:sn,headersMapper:mn},default:{bodyMapper:E,headersMapper:pn}},queryParameters:[U,Hn,nt,rt,os],urlParameters:[v],headerParameters:[Q,C,R,k],serializer:q},gs={path:"/Tables",httpMethod:"POST",responses:{201:{bodyMapper:un,headersMapper:Le},204:{headersMapper:Le},default:{bodyMapper:E,headersMapper:fn}},requestBody:ls,queryParameters:[U],urlParameters:[v],headerParameters:[Q,C,R,k,kn,Un],mediaType:"json",serializer:q},bs={path:"/Tables('{table}')",httpMethod:"DELETE",responses:{204:{headersMapper:yn},default:{bodyMapper:E,headersMapper:hn}},urlParameters:[v,_],headerParameters:[C,R,it],serializer:q},xs={path:"/{table}()",httpMethod:"GET",responses:{200:{bodyMapper:cn,headersMapper:gn},default:{bodyMapper:E,headersMapper:bn}},queryParameters:[U,Hn,nt,rt,M,cs,ds],urlParameters:[v,_],headerParameters:[Q,C,R,k],serializer:q},Ns={path:"/{table}(PartitionKey='{partitionKey}',RowKey='{rowKey}')",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Dictionary",value:{type:{name:"any"}}}},headersMapper:xn},default:{bodyMapper:E,headersMapper:Nn}},queryParameters:[U,nt,rt,M],urlParameters:[v,_,Te,we],headerParameters:[Q,C,R,k],serializer:q},Ps={path:"/{table}(PartitionKey='{partitionKey}',RowKey='{rowKey}')",httpMethod:"PUT",responses:{204:{headersMapper:Pn},default:{bodyMapper:E,headersMapper:Sn}},requestBody:at,queryParameters:[U,M],urlParameters:[v,_,Te,we],headerParameters:[C,R,k,it,Ln,Kn],mediaType:"json",serializer:q},Ss={path:"/{table}(PartitionKey='{partitionKey}',RowKey='{rowKey}')",httpMethod:"PATCH",responses:{204:{headersMapper:Tn},default:{bodyMapper:E,headersMapper:wn}},requestBody:at,queryParameters:[U,M],urlParameters:[v,_,Te,we],headerParameters:[C,R,k,it,Ln,Kn],mediaType:"json",serializer:q},Ts={path:"/{table}(PartitionKey='{partitionKey}',RowKey='{rowKey}')",httpMethod:"DELETE",responses:{204:{headersMapper:En},default:{bodyMapper:E,headersMapper:vn}},queryParameters:[U,M],urlParameters:[v,_,Te,we],headerParameters:[Q,C,R,k,us],serializer:q},ws={path:"/{table}",httpMethod:"POST",responses:{201:{bodyMapper:{type:{name:"Dictionary",value:{type:{name:"any"}}}},headersMapper:Ke},204:{headersMapper:Ke},default:{bodyMapper:E,headersMapper:Cn}},requestBody:at,queryParameters:[U,M],urlParameters:[v,_],headerParameters:[Q,C,R,k,kn,Un],mediaType:"json",serializer:q},Es={path:"/{table}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}},serializedName:"SignedIdentifiers",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier"},headersMapper:Rn},default:{bodyMapper:E,headersMapper:On}},queryParameters:[M,Vn],urlParameters:[v,_],headerParameters:[C,R,st],isXML:!0,serializer:Wn},vs={path:"/{table}",httpMethod:"PUT",responses:{204:{headersMapper:zn},default:{bodyMapper:E,headersMapper:An}},requestBody:ms,queryParameters:[M,Vn],urlParameters:[v,_],headerParameters:[C,R,Bn,jn],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:Wn};class Cs{constructor(e){this.client=e}setProperties(e,n){return this.client.sendOperationRequest({tableServiceProperties:e,options:n},Rs)}getProperties(e){return this.client.sendOperationRequest({options:e},Os)}getStatistics(e){return this.client.sendOperationRequest({options:e},zs)}}const lt=We(tt,!0),Rs={path:"/",httpMethod:"PUT",responses:{202:{headersMapper:Mn},default:{bodyMapper:E,headersMapper:In}},requestBody:ps,queryParameters:[M,ot,Fn],urlParameters:[v],headerParameters:[C,R,Bn,jn],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:lt},Os={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:et,headersMapper:_n},default:{bodyMapper:E,headersMapper:qn}},queryParameters:[M,ot,Fn],urlParameters:[v],headerParameters:[C,R,st],isXML:!0,serializer:lt},zs={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:dn,headersMapper:Dn},default:{bodyMapper:E,headersMapper:$n}},queryParameters:[M,ot,fs],urlParameters:[v],headerParameters:[C,R,st],isXML:!0,serializer:lt};class Gn extends Va{constructor(e,n){var r,i;if(e===void 0)throw new Error("'url' cannot be null");n||(n={});const a={requestContentType:"application/json; charset=utf-8"},s="azsdk-js-data-tables/13.1.2",l=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${s}`:`${s}`,c=Object.assign(Object.assign(Object.assign({},a),n),{userAgentOptions:{userAgentPrefix:l},baseUri:(i=(r=n.endpoint)!==null&&r!==void 0?r:n.baseUri)!==null&&i!==void 0?i:"{url}"});super(c),this.url=e,this.version=n.version||"2019-02-02",this.table=new ys(this),this.service=new Cs(this)}}const As="apiVersionPolicy",Xn=t=>({name:As,sendRequest:async(e,n)=>(e.headers.set("x-ms-version",t),n(e))});function Ms(t,e){throw new Error("Account connection string is only supported in Node.js environment")}function Is(t,e,n,r,i){throw new Error("Account connection string is only supported in Node.js environment")}const _s="DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;TableEndpoint=http://127.0.0.1:10002/devstoreaccount1";function Qn(t,e={}){t.toLowerCase().indexOf("usedevelopmentstorage=true")!==-1&&(t=_s,e.allowInsecureConnection=!0);const n=qs(t);if(n.kind==="AccountConnString")return Ms();if(n.kind==="SASConnString")return{url:`${n.url}?${n.accountSas}`,options:e};throw new Error("Connection string must be either an Account connection string or a SAS connection string")}function qs(t){let e=V(t,"TableEndpoint");return e=e.endsWith("/")?e.slice(0,-1):e,Ds(t)?Is(V(t,"AccountName"),V(t,"AccountKey"),V(t,"DefaultEndpointsProtocol"),V(t,"EndpointSuffix")):$s(t,e)}function Ds(t){const e=t.toLowerCase();return e.search("defaultendpointsprotocol=")!==-1&&e.search("accountkey=")!==-1}function $s(t,e){const n=ks(e),r=V(t,"SharedAccessSignature");if(e)if(r){if(!n)throw new Error("Invalid AccountName in the provided SAS Connection String")}else throw new Error("Invalid SharedAccessSignature in the provided SAS Connection String");else throw new Error("Invalid TableEndpoint in the provided SAS Connection String");return{kind:"SASConnString",url:e,accountName:n,accountSas:r}}function V(t,e){const n=e.toLowerCase(),r=t.split(";").filter(i=>!!i);for(const i of r){const a=i.trim(),[s,l]=Hs(a);if(s.toLowerCase()===n)return l}return""}function Hs(t){if(!t||t.indexOf("=")===-1)return[];const e=t.substr(0,t.indexOf("=")),n=t.substr(t.indexOf("=")+1);return[e,n]}function ks(t){if(!t)return t;const e=new URL(t);let n;const r=e.host||"",i=e.pathname||"",a=r.split("."),s=i.split("/");if(a.length>=1&&a[1]==="table")t=t.endsWith("/")?t.slice(0,-1):t,n=r.split(".")[0];else if(s.length>=1)n=s[1];else throw new Error("Unable to extract accountName with provided information.");return n}function Jn(t,e={}){var n,r;const i=Us(t);if(i&&i.status===409&&((n=i.parsedBody.odataError)===null||n===void 0?void 0:n.code)==="TableAlreadyExists")(r=e.logger)===null||r===void 0||r.info(`Table ${e.tableName} already Exists`),e.onResponse&&e.onResponse(i,{});else throw t}function Us(t){if(!Ls(t))return;const e=t.response;if(!(!e||!Ks(e.parsedBody)))return e}function Ls(t){return t.name==="RestError"}function Ks(t){return!!(t!=null&&t.odataError)}function xe(t){return je(t)||Be(t)||Fe(t)}const F=Ne("data-tables");function Yn(t,e,n){t.removePolicy({name:"bearerTokenPolicy"}),t.addPolicy(en({credential:e,scopes:n,challengeCallbacks:{authorizeRequestOnChallenge:Fa}}),{phase:"Sign"})}function Zn(t){throw new Error("Shared Access Key authentication is not supported in the browser")}const Vs="tablesSASTokenPolicy";function er(t){return{name:Vs,async sendRequest(e,n){return Bs(e,t),n(e)}}}function Bs(t,e){const n=new URLSearchParams(e.signature),r=new URL(t.url);for(const[i,a]of n)r.searchParams.append(i,a);t.url=r.toString()}const N=Jt({namespace:"Microsoft.Data.Tables",packageName:"@azure/data-tables",packageVersion:"13.2.2"});class Ve{constructor(e,n,r){this.url=e;const i=xe(n)?n:void 0,a=(xe(n)?r:n)||{};a.endpoint=a.endpoint||this.url;const s=Object.assign(Object.assign({},a),{loggingOptions:{logger:F.info,additionalAllowedHeaderNames:[...Ct]},deserializationOptions:{parseXML:zt},serializationOptions:{stringifyXML:At}}),l=new Gn(this.url,s);l.pipeline.addPolicy(hr),Be(i)?l.pipeline.addPolicy(Zn()):je(i)&&l.pipeline.addPolicy(er(i)),Fe(i)&&Yn(l.pipeline,i,vt),r!=null&&r.version&&l.pipeline.addPolicy(Xn(r.version)),this.pipeline=l.pipeline,this.table=l.table,this.service=l.service}async getStatistics(e={}){return N.withSpan("TableServiceClient.getStatistics",e,n=>this.service.getStatistics(gr(n)))}getProperties(e={}){return N.withSpan("TableServiceClient.getProperties",e,n=>this.service.getProperties(n))}setProperties(e,n={}){return N.withSpan("TableServiceClient.setProperties",n,r=>this.service.setProperties(e,r))}createTable(e,n={}){return N.withSpan("TableServiceClient.createTable",n,async r=>{try{await this.table.create({name:e},r)}catch(i){Jn(i,Object.assign(Object.assign({},r),{logger:F,tableName:e}))}})}deleteTable(e,n={}){return N.withSpan("TableServiceClient.deleteTable",n,async r=>{try{await this.table.delete(e,r)}catch(i){if(i.statusCode===404)F.info("TableServiceClient.deleteTable: Table doesn't exist");else throw i}})}listTables(e){const n=this.listTablesAll(e);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:r=>{const i=Object.assign(Object.assign({},e),{queryOptions:Object.assign(Object.assign({},e==null?void 0:e.queryOptions),{top:r==null?void 0:r.maxPageSize})});return r!=null&&r.continuationToken&&(i.continuationToken=r.continuationToken),this.listTablesPage(i)}}}listTablesAll(e){return pe(this,arguments,function*(){var r,i;const a=yield S(this._listTables(e)),{continuationToken:s}=a;if(yield S(yield*fe(B(a))),s){const o=Object.assign(Object.assign({},e),{continuationToken:s});try{for(var l=B(this.listTablesPage(o)),c;c=yield S(l.next()),!c.done;){const d=c.value;yield S(yield*fe(B(d)))}}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=l.return)&&(yield S(i.call(l)))}finally{if(r)throw r.error}}}})}listTablesPage(e={}){return pe(this,arguments,function*(){let r=yield S(N.withSpan("TableServiceClient.listTablesPage",e,i=>this._listTables(i)));for(yield yield S(r);r.continuationToken;){const i=Object.assign(Object.assign({},e),{continuationToken:r.continuationToken});r=yield S(N.withSpan("TableServiceClient.listTablesPage",i,async(a,s)=>(s.setAttribute("continuationToken",a.continuationToken),this._listTables(a)))),yield yield S(r)}})}async _listTables(e={}){const{continuationToken:n}=e,r=$(e,["continuationToken"]),{xMsContinuationNextTableName:i,value:a=[]}=await this.table.query(Object.assign(Object.assign({},r),{nextTableName:n}));return Object.assign([...a],{continuationToken:i})}static fromConnectionString(e,n){const{url:r,options:i,credential:a}=Qn(e,n);return a?new Ve(r,a,i):new Ve(r,i)}}function tr(t){return`changeset_${t}`}function js(t){return`batch_${t}`}function Fs(t,e){return[`--${`batch_${t}`}${A}${ye.CONTENT_TYPE}: multipart/mixed; boundary=changeset_${e}${A}${A}`]}function Ws(t,e,n){const r=js(e),a=`--${tr(n)}--`,s=`--${r}--`;return`${t.join(A)}${A}${a}${A}${s}${A}`}const nr="transactionRequestAssemblePolicy",Gs={request:Ze({url:"FAKE"}),status:200,headers:Se()};function Xs(t,e){return{name:nr,async sendRequest(n){const r=Ys(n,e);return t.push(r),Gs}}}const rr="transactionHeaderFilterPolicy";function Qs(){return{name:rr,async sendRequest(t,e){return t.headers.delete(ye.X_MS_VERSION),e(t)}}}function Js(t){const e=["sv","ss","srt","sp","se","st","spr","sig"],n=new URL(t);return e.forEach(r=>n.searchParams.delete(r)),n.toString()}function Ys(t,e){const r=`--${tr(e)}${A}${ye.CONTENT_TYPE}: application/http${A}${ye.CONTENT_TRANSFER_ENCODING}: binary`,i=Js(t.url),a=[r,"",`${t.method.toString()} ${i} ${pr}`];for(const[s,l]of t.headers)a.push(`${s}: ${l}`);return a.push(`${A}`),t.body&&a.push(String(t.body)),a.join(A)}const Zs="cosmosPatchPolicy";function ir(){return{name:Zs,sendRequest:(t,e)=>(t.method==="PATCH"&&(t.method="POST",t.headers.set("X-HTTP-Method","MERGE")),e(t))}}function eo(t){return{accept:"application/json","x-ms-version":"2019-02-02",DataServiceVersion:"3.0;",MaxDataServiceVersion:"3.0;NetFx","Content-Type":`multipart/mixed; boundary=batch_${t}`}}const to=eo;function ar(t){const e=new URL(t);return e.hostname.indexOf(".table.cosmosdb.")!==-1||e.hostname.indexOf(".table.cosmos.")!==-1||e.hostname==="localhost"&&e.port!=="10002"}class no{constructor(e,n,r,i,a,s,l,c=!1){if(this.client=a,this.url=e,this.interceptClient=s,this.allowInsecureConnection=c,this.state=this.initializeState(r,i,n),l)this.url=`${this.getUrlWithSlash()}$batch`;else{const o=e.split("?");this.url=o[0];const d=o.length>1?`?${o[1]}`:"";this.url=`${this.getUrlWithSlash()}$batch${d}`}}initializeState(e,n,r){const i=[],a=Fs(e,n),s=ar(this.url);return io(this.interceptClient.pipeline,a,n,s),{transactionId:e,changesetId:n,partitionKey:r,pendingOperations:i,bodyParts:a}}createEntity(e){this.checkPartitionKey(e.partitionKey),this.state.pendingOperations.push(this.interceptClient.createEntity(e))}createEntities(e){for(const n of e)this.checkPartitionKey(n.partitionKey),this.state.pendingOperations.push(this.interceptClient.createEntity(n))}deleteEntity(e,n,r){this.checkPartitionKey(e),this.state.pendingOperations.push(this.interceptClient.deleteEntity(e,n,r))}updateEntity(e,n,r){this.checkPartitionKey(e.partitionKey),this.state.pendingOperations.push(this.interceptClient.updateEntity(e,n,r))}upsertEntity(e,n,r){this.checkPartitionKey(e.partitionKey),this.state.pendingOperations.push(this.interceptClient.upsertEntity(e,n,r))}async submitTransaction(){await Promise.all(this.state.pendingOperations);const e=Ws(this.state.bodyParts,this.state.transactionId,this.state.changesetId),n=to(this.state.transactionId);return N.withSpan("TableTransaction.submitTransaction",{},async r=>{const i=Ze({url:this.url,method:"POST",body:e,headers:Se(n),tracingOptions:r.tracingOptions,allowInsecureConnection:this.allowInsecureConnection}),a=await this.client.sendRequest(i);return ro(a)})}checkPartitionKey(e){if(this.state.partitionKey!==e)throw new Error("All operations in a transaction must target the same partitionKey")}getUrlWithSlash(){return this.url.endsWith("/")?this.url:`${this.url}/`}}function ro(t){const e="--changesetresponse_",n=t.status,r=t.bodyAsText||"",i=r.split(e);200<=n&&n<300||St(r,n,t.request,t);const l=i.slice(1,i.length-1).map(c=>{const o=c.match(/HTTP\/1.1 ([0-9]*)/);if((o==null?void 0:o.length)!==2)throw new Error(`Couldn't extract status from sub-response:
 ${c}`);const d=Number.parseInt(o[1]);if(!Number.isInteger(d))throw new Error(`Expected sub-response status to be an integer ${d}`);const m=c.match(/\{(.*)\}/);(m==null?void 0:m.length)===2&&St(m[0],d,t.request,t);const u=c.match(/ETag: (.*)/),f=c.match(/RowKey='(.*)'/);return Object.assign(Object.assign({status:d},(f==null?void 0:f.length)===2&&{rowKey:f[1]}),(u==null?void 0:u.length)===2&&{etag:u[1]})});return{status:n,subResponses:l,getResponseForEntity:c=>l.find(o=>o.rowKey===c)}}function St(t,e,n,r){var i,a;let s;try{s=JSON.parse(t)}catch{s={}}let l="Transaction Failed",c;if(s&&s["odata.error"]){const o=s["odata.error"];l=(a=(i=o.message)===null||i===void 0?void 0:i.value)!==null&&a!==void 0?a:l,c=o.code}throw new z(l,{code:c,statusCode:e,request:n,response:r})}function io(t,e,n,r){const i=t.getOrderedPolicies();for(const a of i)t.removePolicy({name:a.name});t.addPolicy(rn(),{phase:"Serialize"}),t.addPolicy(Qs()),t.addPolicy(Xs(e,n)),r&&t.addPolicy(ir(),{afterPolicies:[rr],beforePolicies:[nn,nr]})}function sr(t){let e="";if(typeof t=="string")e=t;else for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function or(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}function ao(t,e){if(!t)return;const n=Object.assign({nextPartitionKey:t},e&&{nextRowKey:e});return sr(JSON.stringify(n))}function so(t){const e=or(t);let n="";for(const i of e)n+=String.fromCharCode(i);return JSON.parse(n)}const ct=new Map([["PartitionKey","partitionKey"],["RowKey","rowKey"],["odata.etag","etag"],["Timestamp","timestamp"]]),O={Binary:"Edm.Binary",Boolean:"Edm.Boolean",DateTime:"Edm.DateTime",Double:"Edm.Double",Guid:"Edm.Guid",Int32:"Edm.Int32",Int64:"Edm.Int64",String:"Edm.String"};function oo(t){const e={value:t};if(t==null||typeof t=="boolean"||typeof t=="string"||typeof t=="number")e.value=t;else if(typeof t=="bigint")e.value=t.toString(),e.type=O.Int64;else if(t instanceof Date)e.value=t,e.type=O.DateTime;else if(t instanceof Uint8Array)e.value=sr(t),e.type=O.Binary;else throw new Error(`Unknown EDM type ${typeof t}`);return e}function lo(t){const e={value:t.value};if(t.type==="Boolean"||t.type==="DateTime"||t.type==="Double"||t.type==="Guid"||t.type==="Int32"||t.type==="Int64"||t.type==="String"||t.type==="Binary")e.value=t.value,e.type=O[t.type];else throw new Error(`Unknown EDM type ${typeof t.value}`);return e}function co(t){return typeof t=="object"&&(t==null?void 0:t.value)!==void 0&&(t==null?void 0:t.type)!==void 0?lo(t):oo(t)}function lr(t){for(const[e,n]of ct)if(n===t)return e;return t}function ee(t){const e={};for(const[n,r]of Object.entries(t)){const i=lr(n),a=co(r);e[i]=a.value,a.type&&(e[`${i}@odata.type`]=a.type)}return e}function uo(t,e,n){switch(e){case O.Boolean:return n?{value:t,type:"Boolean"}:t;case O.Double:return n?{value:t,type:"Double"}:t;case O.Int32:return n?{value:t,type:"Int32"}:t;case O.String:return n?{value:t,type:"String"}:t;case O.DateTime:return n?{value:t,type:"DateTime"}:new Date(t);case O.Int64:return n?{value:t,type:"Int64"}:BigInt(t);case O.Guid:return{value:t,type:"Guid"};case O.Binary:return n?{value:t,type:"Binary"}:or(t);default:throw new Error(`Unknown EDM type ${e}`)}}function cr(t,e=!1){var n;const r={};for(const[i,a]of Object.entries(t))if(i.indexOf("@odata.type")===-1){const s=(n=ct.get(i))!==null&&n!==void 0?n:i;let l=a;if(`${i}@odata.type`in t){const c=t[`${i}@odata.type`];l=uo(a,c,e)}else e&&["number","string","boolean"].includes(typeof a)&&(l=mo(i,a));r[s]=l}return r}function mo(t,e){if(ct.has(t))return e;switch(typeof e){case"boolean":return{value:String(e),type:"Boolean"};case"number":return po(e);case"string":return{value:e,type:"String"};default:return e}}function po(t){const e=String(t);return Number.isSafeInteger(t)?{value:e,type:"Int32"}:{value:e,type:"Double"}}function fo(t,e){return t.map(n=>cr(n,e))}function yo(t){return t.map(e=>{const{id:n,accessPolicy:r}=e,i=r??{},{start:a,expiry:s}=i,l=$(i,["start","expiry"]),c=a?ut(a,!1):void 0,o=s?ut(s,!1):void 0;return{id:n,accessPolicy:Object.assign(Object.assign(Object.assign({},o&&{expiry:o}),c&&{start:c}),l)}})}function ho(t){return t.map(e=>{const{id:n,accessPolicy:r}=e,i=r??{},{start:a,expiry:s}=i,l=$(i,["start","expiry"]),c=a?new Date(a):void 0,o=s?new Date(s):void 0;return{id:n,accessPolicy:Object.assign(Object.assign(Object.assign({},o&&{expiry:o}),c&&{start:c}),l)}})}function Tt(t){const{select:e}=t,n=$(t,["select"]),r=Object.assign({},n),i=["etag","odata.etag"];return e&&(r.select=e.filter(a=>!i.includes(a)).map(lr).join(",")),r}var de,go=new Uint8Array(16);function bo(){if(!de&&(de=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!de))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return de(go)}const xo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function No(t){return typeof t=="string"&&xo.test(t)}var T=[];for(var Oe=0;Oe<256;++Oe)T.push((Oe+256).toString(16).substr(1));function Po(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(T[t[e+0]]+T[t[e+1]]+T[t[e+2]]+T[t[e+3]]+"-"+T[t[e+4]]+T[t[e+5]]+"-"+T[t[e+6]]+T[t[e+7]]+"-"+T[t[e+8]]+T[t[e+9]]+"-"+T[t[e+10]]+T[t[e+11]]+T[t[e+12]]+T[t[e+13]]+T[t[e+14]]+T[t[e+15]]).toLowerCase();if(!No(n))throw TypeError("Stringified UUID is invalid");return n}function So(t,e,n){t=t||{};var r=t.random||(t.rng||bo)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return Po(r)}class wt{static generateUuid(){return So()}}function D(t){return t.replace(/'/g,"''")}class me{constructor(e,n,r,i={}){var a;this.url=e,this.tableName=n;const s=xe(r)?r:void 0;this.credential=s,this.clientOptions=(xe(r)?i:r)||{},this.allowInsecureConnection=(a=this.clientOptions.allowInsecureConnection)!==null&&a!==void 0?a:!1,this.clientOptions.endpoint=this.clientOptions.endpoint||this.url;const l=Object.assign(Object.assign({},this.clientOptions),{loggingOptions:{logger:F.info,additionalAllowedHeaderNames:[...Ct]},deserializationOptions:{parseXML:zt},serializationOptions:{stringifyXML:At}}),c=new Gn(this.url,l);Be(s)?c.pipeline.addPolicy(Zn()):je(s)&&c.pipeline.addPolicy(er(s)),Fe(s)&&Yn(c.pipeline,s,vt),ar(this.url)&&c.pipeline.addPolicy(ir()),i.version&&c.pipeline.addPolicy(Xn(i.version)),this.generatedClient=c,this.table=c.table,this.pipeline=c.pipeline}deleteTable(e={}){return N.withSpan("TableClient.deleteTable",e,async n=>{try{await this.table.delete(this.tableName,n)}catch(r){if(r.statusCode===404)F.info("TableClient.deleteTable: Table doesn't exist");else throw r}})}createTable(e={}){return N.withSpan("TableClient.createTable",e,async n=>{try{await this.table.create({name:this.tableName},n)}catch(r){Jn(r,Object.assign(Object.assign({},n),{logger:F,tableName:this.tableName}))}})}getEntity(e,n,r={}){return N.withSpan("TableClient.getEntity",r,async i=>{let a;function s(m,u){a=m.parsedBody,i.onResponse&&i.onResponse(m,u)}const{disableTypeConversion:l,queryOptions:c}=i,o=$(i,["disableTypeConversion","queryOptions"]);return await this.table.queryEntitiesWithPartitionAndRowKey(this.tableName,D(e),D(n),Object.assign(Object.assign({},o),{queryOptions:Tt(c||{}),onResponse:s})),cr(a,l??!1)})}listEntities(e={}){const n=this.tableName,r=this.listEntitiesAll(n,e);return{next(){return r.next()},[Symbol.asyncIterator](){return this},byPage:i=>{const a=Object.assign(Object.assign({},e),{queryOptions:Object.assign(Object.assign({},e.queryOptions),{top:i==null?void 0:i.maxPageSize})});return i!=null&&i.continuationToken&&(a.continuationToken=i.continuationToken),this.listEntitiesPage(n,a)}}}listEntitiesAll(e,n){return pe(this,arguments,function*(){var i,a;const s=yield S(this._listEntities(e,n));if(yield S(yield*fe(B(s))),s.continuationToken){const o=Object.assign(Object.assign({},n),{continuationToken:s.continuationToken});try{for(var l=B(this.listEntitiesPage(e,o)),c;c=yield S(l.next()),!c.done;){const d=c.value;yield S(yield*fe(B(d)))}}catch(d){i={error:d}}finally{try{c&&!c.done&&(a=l.return)&&(yield S(a.call(l)))}finally{if(i)throw i.error}}}})}listEntitiesPage(e,n={}){return pe(this,arguments,function*(){let i=yield S(N.withSpan("TableClient.listEntitiesPage",n,a=>this._listEntities(e,a)));for(yield yield S(i);i.continuationToken;){const a=Object.assign(Object.assign({},n),{continuationToken:i.continuationToken});i=yield S(N.withSpan("TableClient.listEntitiesPage",a,(s,l)=>(l.setAttribute("continuationToken",i.continuationToken),this._listEntities(e,s)))),yield yield S(i)}})}async _listEntities(e,n={}){const{disableTypeConversion:r=!1}=n,i=Tt(n.queryOptions||{}),a=Object.assign(Object.assign({},n),{queryOptions:i});if(n.continuationToken){const u=so(n.continuationToken);a.nextRowKey=u.nextRowKey,a.nextPartitionKey=u.nextPartitionKey}const{xMsContinuationNextPartitionKey:s,xMsContinuationNextRowKey:l,value:c}=await this.table.queryEntities(e,a),o=fo(c??[],r),d=ao(s,l);return Object.assign([...o],{continuationToken:d})}createEntity(e,n={}){return N.withSpan("TableClient.createEntity",n,r=>{const i=$(r||{},[]);return this.table.insertEntity(this.tableName,Object.assign(Object.assign({},i),{tableEntityProperties:ee(e),responsePreference:"return-no-content"}))})}deleteEntity(e,n,r={}){return N.withSpan("TableClient.deleteEntity",r,i=>{const{etag:a="*"}=i,s=$(i,["etag"]),l=Object.assign({},s);return this.table.deleteEntity(this.tableName,D(e),D(n),a,l)})}updateEntity(e,n="Merge",r={}){return N.withSpan("TableClient.updateEntity",r,async i=>{const a=D(e.partitionKey),s=D(e.rowKey),l=i||{},{etag:c="*"}=l,o=$(l,["etag"]);if(n==="Merge")return this.table.mergeEntity(this.tableName,a,s,Object.assign({tableEntityProperties:ee(e),ifMatch:c},o));if(n==="Replace")return this.table.updateEntity(this.tableName,a,s,Object.assign({tableEntityProperties:ee(e),ifMatch:c},o));throw new Error(`Unexpected value for update mode: ${n}`)},{spanAttributes:{updateEntityMode:n}})}upsertEntity(e,n="Merge",r={}){return N.withSpan("TableClient.upsertEntity",r,async i=>{const a=D(e.partitionKey),s=D(e.rowKey);if(n==="Merge")return this.table.mergeEntity(this.tableName,a,s,Object.assign({tableEntityProperties:ee(e)},i));if(n==="Replace")return this.table.updateEntity(this.tableName,a,s,Object.assign({tableEntityProperties:ee(e)},i));throw new Error(`Unexpected value for update mode: ${n}`)},{spanAttributes:{upsertEntityMode:n}})}getAccessPolicy(e={}){return N.withSpan("TableClient.getAccessPolicy",e,async n=>{const r=await this.table.getAccessPolicy(this.tableName,n);return ho(r)})}setAccessPolicy(e,n={}){return N.withSpan("TableClient.setAccessPolicy",n,r=>{const i=yo(e);return this.table.setAccessPolicy(this.tableName,Object.assign(Object.assign({},r),{tableAcl:i}))})}async submitTransaction(e){const n=e[0][1].partitionKey,r=wt.generateUuid(),i=wt.generateUuid(),a=new no(this.url,n,r,i,this.generatedClient,new me(this.url,this.tableName),this.credential,this.allowInsecureConnection);for(const s of e){const[l,c,o="Merge",d]=s;switch(l){case"create":a.createEntity(c);break;case"delete":a.deleteEntity(c.partitionKey,c.rowKey);break;case"update":a.updateEntity(c,o,d);break;case"upsert":a.upsertEntity(c,o)}}return a.submitTransaction()}static fromConnectionString(e,n,r){const{url:i,options:a,credential:s}=Qn(e,r);return s?new me(i,n,s,a):new me(i,n,a)}}export{Ve as T,me as a};
